package frontend

import groovymvc.AbstractMvcFilter
import groovymvc.Controller
import org.openforis.sepal.endpoint.Server
import org.slf4j.Logger
import org.slf4j.LoggerFactory

import javax.servlet.ServletContext

import static groovy.json.JsonOutput.toJson

class MockServer extends AbstractMvcFilter {
    private static final Logger LOG = LoggerFactory.getLogger(this)

    Controller bootstrap(ServletContext servletContext) {
        def authenticator = new FakeAuthenticator()
        def controller = Controller.builder(servletContext)
                .build()

        controller.with {
            get('/user') {
                response.contentType = 'application/json'
                send toJson(authenticator.users.values().first())
//                    halt(401)
            }

            get('/user/files') {
                response.contentType = 'application/json'

                def homeDir = new File(System.getProperty("user.home"))
                def path = params.path
                def dir = new File(homeDir.absolutePath + path).canonicalFile
                def files = []
                dir.eachFile { file ->
                    files << [name: file.name, isDirectory: file.directory, size: file.size()]
                }
                send toJson(files)
            }

            get('/user/files/download') {
                //TODO
                def path = params.path

            }

            delete('/sandbox/session/{sessionId}') {
                response.contentType = 'application/json'

                response.status = 200

                send toJson("[status:OK]")
            }


            get('/sandbox/report'){
                response.contentType = 'application/json'

                send toJson(
                        sessions: [[
                                           id: 'some-session',
                                           path: 'sandbox/session/some-session',
                                           username: authenticator.users.values().first().username,
                                           status: 'STARTING',
                                           host: 'some-host',
                                           instanceType: [
                                                   path: "sandbox/instance-type/some-instance-type",
                                                   id: 'some-instance-type',
                                                   name: 'Some instance type',
                                                   description: 'Some instance type description',
                                                   hourlyCost: 0.1
                                           ],
                                           creationTime: '2016-01-01T00:00:00',
                                           costSinceCreation: 0.1 * 2 * 24 // hourly cost * two days
                                   ]],
                        instanceTypes: [[
                                                path: "sandbox/instance-type/some-instance-type",
                                                id: 'some-instance-type',
                                                name: 'Some instance type',
                                                description: 'Some instance type description',
                                                hourlyCost: 0.1
                                        ]],
                        spending: [
                                monthlyInstanceBudget: 1d,
                                monthlyInstanceSpending: 2d,
                                monthlyStorageBudget: 3d,
                                monthlyStorageSpending: 4d,
                                storageQuota: 5d,
                                storageUsed: 6d
                        ]
                )
            }

            post('/data/scenes/retrieve') {
//  { countryIso:ITA, scenes:[ {sceneId: 'LC81900302015079LGN00', sensor: 'LC8'}, ... ] }
//                params.selection

                send toJson("[status:OK]")
            }
            post('/data/scenes/mosaic') {
//  { countryIso:ITA, scenes:[ {sceneId: 'LC81900302015079LGN00', sensor: 'LC8'}, ... ] }
//                params.selection

                send toJson("[status:OK]")
            }

            get('/tasks') {
                response.contentType = 'application/json'
                //'ACTIVE|FAILED|COMPLETED|PENDING',
                def tasks = [
                        [
                                id               : 'a',
                                name             : 'downloading scene LC81900302015079LGN00 from some part of hte universe',
                                status           : 'ACTIVE',
                                statusDescription: 'currently downloading something from somewhere'
                        ]
                        , [
                                id               : 'b',
                                name             : 'ciao2',
                                status           : 'PENDING',
                                statusDescription: 'currently downloading something from somewhere'
                        ]
                        , [
                                id               : 'c',
                                name             : 'ciao3',
                                status           : 'COMPLETED',
                                statusDescription: 'currently downloading something from somewhere'
                        ]
                        , [
                                id               : 'd',
                                name             : 'ciao4',
                                status           : 'FAILED',
                                statusDescription: 'currently downloading something from somewhere'
                        ]
                ]
                send toJson(tasks)
            }

            /**
             * Valid when status is ACTIVE or PENDING.
             */
            post('/tasks/task/{id}/cancel') {
                response.status = 204
            }

            /**
             * Valid when status is COMPLETED or FAILED.
             */
            post('/tasks/task/{id}/remove') {
                response.status = 204
            }

            /**
             * Valid when status is COMPLETED or FAILED.
             */
            post('/tasks/task/{id}/execute') {
                response.status = 204
            }

            /**
             * Removes all COMPLETED or FAILED tasks.
             */
            post('/tasks/remove') {
                response.status = 204
            }

            post('/login') {
                response.contentType = 'application/json'

                if (params.password == 'demo')
                    send toJson(authenticator.users.values().first())
                else
                    halt(401)
            }


            get('/data/sceneareas') {
                response.contentType = 'application/json'

                params.countryIso
//                params.polygon

                send '[{"polygon": [[41.16655400000001, 13.844318000000003], [41.09763100000001, 14.317839999999999], [41.0587779, 14.584775999999998], [40.941146, 15.392943000000006], [40.8527, 16.0006], [40.890829000000004, 16.013815], [42.310794, 16.505958000000003], [42.349000000000004, 16.5192], [42.587601, 14.881012], [42.591862, 14.851753], [42.63078000000001, 14.584550000000007], [42.67013799999999, 14.314325999999998], [42.6701999, 14.313899999999999], [42.63007900000001, 14.301361000000004], [42.595847, 14.290663000000002], [42.5875999, 14.288086], [42.506091, 14.262613], [41.240842, 13.867202], [41.199418, 13.854256000000001], [41.1666, 13.844], [41.16655400000001, 13.844318000000003]], "sceneAreaId": "189_31"}, {"polygon": [[39.735846, 13.412069000000004], [39.716102, 13.5477749], [39.604075, 14.317755], [39.565258, 14.5845499], [39.42839990000002, 15.525200000000003], [39.462352, 15.536543899999998], [39.716102, 15.621325000000002], [39.797699, 15.6485869], [39.939293, 15.695896], [40.890829000000004, 16.013815], [40.926699899999996, 16.0258], [41.0223749, 15.368380000000002], [41.097592, 14.8515289], [41.136446, 14.5845499], [41.240842, 13.867202], [41.24089989999999, 13.8667999], [41.199418, 13.854256000000001], [41.16655400000001, 13.844318000000003], [41.02237490000002, 13.800719999999998], [40.941117, 13.7761479], [39.939293, 13.473204], [39.810258, 13.434185], [39.7778289, 13.424378899999997], [39.73589989999999, 13.411700000000002], [39.735846, 13.412069000000004]], "sceneAreaId": "189_32"}, {"polygon": [[38.230589, 15.139039000000007], [39.462352, 15.536543899999998], [39.5025, 15.5494999], [39.604075, 14.851344999999998], [39.642891000000006, 14.584550000000004], [39.797699, 13.520513000000005], [39.810258, 13.434185], [39.8103, 13.433899899999998], [39.7778289, 13.424378899999997], [39.735846, 13.412069000000004], [38.37835189999999, 13.01403], [38.33752590000001, 13.00206], [38.3039, 12.992199999999999], [38.30386, 12.992472], [38.1491309, 14.056439], [38.1111379, 14.317685900000004], [38.072323, 14.5845879], [38.0024, 15.065399999999999], [38.033684, 15.075496], [38.149137, 15.1127539], [38.230589, 15.139039000000007]], "sceneAreaId": "189_33"}, {"polygon": [[36.666758, 14.6485529], [38.033684, 15.075496], [38.07659999999999, 15.088899999999999], [38.111133, 14.85144599999999], [38.149948900000005, 14.584550000000004], [38.230576, 14.030150000000004], [38.37835189999999, 13.01403], [38.3783999, 13.013700000000002], [38.33752590000001, 13.00206], [38.30386, 12.992472], [36.94515200000001, 12.605530900000003], [36.899983000000006, 12.592668], [36.87060000000001, 12.584300000000006], [36.87056900000001, 12.584515899999998], [36.585481, 14.545635], [36.58543600000001, 14.545947], [36.57982400000001, 14.584550000000004], [36.5747, 14.619799999999998], [36.585436, 14.623152899999992], [36.616754000000014, 14.6329349], [36.666758, 14.6485529]], "sceneAreaId": "189_34"}, {"polygon": [[39.735846, 16.502169], [39.716087, 16.637980000000006], [39.60407300000001, 17.407872], [39.565254, 17.674678], [39.428399900000024, 18.6153], [39.462352, 18.626644], [39.716101, 18.711424], [39.797684000000004, 18.738682], [39.939293, 18.785996], [40.890828899999995, 19.103915], [40.926699899999996, 19.1159], [41.022379, 18.458479], [41.097589, 17.941706], [41.13644800000001, 17.674700000000005], [41.240855, 16.957305999999996], [41.2409, 16.957], [41.209086, 16.9473779], [41.166540000000005, 16.934509000000006], [41.022377, 16.890906000000005], [40.94111399999999, 16.8663269], [39.9394289, 16.563359], [39.810258, 16.52429], [39.7775279, 16.514391000000003], [39.735899999999994, 16.501799900000005], [39.735846, 16.502169]], "sceneAreaId": "187_32"}, {"polygon": [[38.149130899999996, 17.146539], [38.1111379, 17.4077859], [38.07232100000002, 17.67470000000001], [38.0024, 18.155500000000004], [38.043323, 18.168706000000004], [38.149129, 18.202851], [38.230589, 18.229139], [39.462352, 18.626644], [39.5025, 18.6396], [39.604072, 17.941466000000002], [39.642888, 17.674673], [39.797683, 16.610718], [39.810258, 16.52429], [39.8103, 16.524], [39.7775279, 16.514391000000003], [39.735846, 16.502169], [38.378366, 16.104134900000002], [38.349158, 16.09557], [38.303900000000006, 16.082300000000004], [38.3038469, 16.082663], [38.149130899999996, 17.146539]], "sceneAreaId": "187_33"}, {"polygon": [[36.666759, 17.738753], [38.043323, 18.168706000000004], [38.0766, 18.179099900000008], [38.1111379, 17.941614], [38.149956, 17.67470000000001], [38.2305909, 17.120245000000004], [38.378366, 16.104134900000002], [38.3784, 16.1039], [38.349158, 16.09557], [38.3038469, 16.082663], [36.945165, 15.69564], [36.912722, 15.686398999999998], [36.87060000000001, 15.674400000000002], [36.87055500000002, 15.674711999999998], [36.58548100000001, 17.635831], [36.585451, 17.636042], [36.579831, 17.674699000000004], [36.5747, 17.709999999999997], [36.58545100000001, 17.713358], [36.6065369, 17.719943999999998], [36.666759, 17.738753]], "sceneAreaId": "187_34"}, {"polygon": [[45.4498299, 5.960739000000002], [45.11379990000002, 8.265589900000002], [45.149793, 8.279698], [46.56525800000001, 8.83449], [46.6034, 8.84944], [46.948417, 6.48471], [46.94850000000001, 6.484140000000001], [46.908667, 6.4702149], [46.874328, 6.458210999999998], [45.52393, 5.986139000000001], [45.486916, 5.973200000000001], [45.4499, 5.960260000000003], [45.4498299, 5.960739000000002]], "sceneAreaId": "195_28"}, {"polygon": [[44.023636, 5.482011], [43.6955, 7.73386], [43.7298069, 7.7467369], [45.149793, 8.279698], [45.1875, 8.29385], [45.52393, 5.986139000000001], [45.5239999, 5.985659999999998], [45.486916, 5.973200000000001], [45.4498299, 5.960739000000002], [44.097837, 5.50648], [44.061274000000004, 5.494194000000001], [44.02369999999999, 5.481569900000001], [44.023636, 5.482011]], "sceneAreaId": "195_29"}, {"polygon": [[42.552998, 5.314463], [42.50615599999999, 5.6361040000000004], [42.2751, 7.222670000000002], [42.311492, 7.235780000000004], [43.7298069, 7.7467369], [43.7694, 7.761], [44.097837, 5.50648], [44.0979, 5.50605], [44.061274000000004, 5.494194000000001], [44.023636, 5.482011], [43.50508190000002, 5.3141620000000005], [42.670142, 5.043901], [42.632556000000015, 5.031734899999999], [42.5959, 5.019870000000001], [42.595843, 5.020260899999999], [42.591906, 5.0472928999999995], [42.552998, 5.314463]], "sceneAreaId": "195_30"}, {"polygon": [[46.87432800000001, 8.003282], [46.5298, 10.365], [46.56520799999999, 10.379531000000002], [47.979468, 10.959921], [48.01670000000001, 10.9751999], [48.3710089, 8.549179900000002], [48.371100000000006, 8.5485599], [48.33204, 8.534317], [48.2970189, 8.521546000000004], [46.948417, 8.02978], [46.908669, 8.015286], [46.8744, 8.0027899], [46.87432800000001, 8.003282]], "sceneAreaId": "194_27"}, {"polygon": [[45.449830000000006, 7.505819], [45.11379990000001, 9.810659900000001], [45.150395, 9.825003], [46.56520799999999, 10.379531000000002], [46.6034, 10.3945], [46.948417, 8.02978], [46.9485, 8.02921], [46.908669, 8.015286], [46.87432800000001, 8.003282], [45.52392999999999, 7.531218900000001], [45.486934, 7.518286000000001], [45.4499, 7.5053399999999995], [45.449830000000006, 7.505819]], "sceneAreaId": "194_28"}, {"polygon": [[44.023637, 7.027082000000001], [43.6955, 9.27893], [43.72979200000001, 9.291801000000001], [45.150395, 9.825003], [45.1875, 9.838930000000003], [45.52392999999999, 7.531218900000001], [45.52399990000001, 7.530739900000003], [45.486934, 7.518286000000001], [45.449830000000006, 7.505819], [44.097836, 7.051558999999999], [44.0604609, 7.039001], [44.0237, 7.02665], [44.023637, 7.027082000000001]], "sceneAreaId": "194_29"}, {"polygon": [[42.552998, 6.859527899999999], [42.50615899999999, 7.181154], [42.2751, 8.76774], [42.312205, 8.781107000000004], [43.72979200000001, 9.291801000000001], [43.7694, 9.306069999999998], [44.097836, 7.051558999999999], [44.0979, 7.05112], [44.0604609, 7.039001], [44.023637, 7.027082000000001], [43.505066, 6.859227000000001], [42.670142, 6.588970899999999], [42.632578, 6.576812000000002], [42.5959, 6.564939999999999], [42.59584300000001, 6.565332], [42.5919079, 6.592353899999999], [42.552998, 6.859527899999999]], "sceneAreaId": "194_30"}, {"polygon": [[41.166545899999996, 6.119034000000001], [41.09763000000001, 6.5925109], [41.058774, 6.859461], [40.941147, 7.667601], [40.8527, 8.27526], [40.89002790000001, 8.288197000000002], [42.312205, 8.781107000000004], [42.348999899999995, 8.79386], [42.58759700000001, 7.155703999999998], [42.591858, 7.1264460000000005], [42.630778, 6.859231], [42.670142, 6.588970899999999], [42.6701999, 6.58857], [42.632578, 6.576812000000002], [42.59584300000001, 6.565332], [42.58759599999999, 6.562754], [42.5060829, 6.537280000000001], [41.24085000000001, 6.141865], [41.205225, 6.130731000000002], [41.1666, 6.11866], [41.166545899999996, 6.119034000000001]], "sceneAreaId": "194_31"}, {"polygon": [[39.735852, 5.686711999999999], [39.71609600000001, 5.8224969], [39.60407300000001, 6.5924349], [39.56525500000001, 6.859235000000002], [39.4283999, 7.79985], [39.464895, 7.8120429000000025], [39.71609600000001, 7.895973000000004], [39.797688, 7.923234000000003], [39.93934800000001, 7.970564000000001], [40.89002790000001, 8.288197000000002], [40.926699899999996, 8.300450000000001], [41.022377, 7.643035], [41.097591, 7.126228000000001], [41.1364469, 6.859235], [41.24085000000001, 6.141865], [41.2409, 6.141520000000002], [41.205225, 6.130731000000002], [41.166545899999996, 6.119034000000001], [41.022377, 6.075435], [40.941117, 6.05086], [39.93934800000002, 5.747906000000002], [39.810253, 5.708866000000002], [39.773441, 5.697733], [39.7358999, 5.6863800000000015], [39.735852, 5.686711999999999]], "sceneAreaId": "194_32"}, {"polygon": [[46.874331, 11.093375900000002], [46.5298, 13.4551], [46.565263, 13.469653000000003], [47.979468, 14.050021000000005], [48.01670000000001, 14.065299999999997], [48.371013000000005, 11.639292899999997], [48.371100000000006, 11.6387], [48.333741, 11.625075899999999], [48.297015, 11.611683000000001], [46.94841400000001, 11.119890999999999], [46.9074259, 11.104944], [46.8744, 11.092899999999998], [46.874331, 11.093375900000002]], "sceneAreaId": "192_27"}, {"polygon": [[45.449830000000006, 10.595979], [45.11379990000002, 12.900800000000006], [45.14623300000002, 12.913511], [46.565263, 13.469653000000003], [46.6034, 13.484600000000002], [46.94841400000001, 11.119890999999999], [46.9485, 11.119300000000003], [46.9074259, 11.104944], [46.874331, 11.093375900000002], [45.5239309, 10.621375900000004], [45.48704400000001, 10.608482999999998], [45.4499, 10.595500000000003], [45.449830000000006, 10.595979]], "sceneAreaId": "192_28"}, {"polygon": [[44.023646899999996, 10.117167], [43.6955, 12.369], [43.733818000000014, 12.383381999999997], [45.14623300000002, 12.913511], [45.1875, 12.928999900000003], [45.5239309, 10.621375900000004], [45.52400000000001, 10.620899899999998], [45.48704400000001, 10.608482999999998], [45.449830000000006, 10.595979], [44.097826, 10.141706], [44.054848, 10.127266000000002], [44.0236999, 10.116799999999998], [44.023646899999996, 10.117167]], "sceneAreaId": "192_29"}, {"polygon": [[42.55299490000001, 9.949678000000002], [42.506163, 10.2712609], [42.2751, 11.857900000000003], [42.310794, 11.870758], [43.733818000000014, 12.383381999999997], [43.7694, 12.396200000000002], [44.097826, 10.141706], [44.0979, 10.141199899999997], [44.054848, 10.127266000000002], [44.023646899999996, 10.117167], [43.505150000000015, 9.949348999999998], [42.670142, 9.679089], [42.63266599999999, 9.66696], [42.5959, 9.65506], [42.59584300000001, 9.655451899999996], [42.5919079, 9.682472], [42.55299490000001, 9.949678000000002]], "sceneAreaId": "192_30"}, {"polygon": [[41.166547, 9.209145], [41.09762800000001, 9.682643], [41.058776, 9.9495759], [40.941146, 10.757742999999998], [40.8527, 11.3654], [40.890828899999995, 11.378615], [42.310794, 11.870758], [42.349000000000004, 11.884], [42.5875999, 10.245812], [42.591854, 10.216599], [42.6307789, 9.949348000000002], [42.670142, 9.679089], [42.6701999, 9.67869], [42.63266599999999, 9.66696], [42.59584300000001, 9.655451899999996], [42.58759700000001, 9.652875], [42.506076, 9.627397], [41.240848, 9.231984], [41.20425999999999, 9.220549999999998], [41.1666, 9.20878], [41.166547, 9.209145]], "sceneAreaId": "192_31"}, {"polygon": [[39.73585189999999, 8.776832], [39.716094, 8.912628], [39.604072, 9.682579000000002], [39.565256000000005, 9.949363900000005], [39.42839990000002, 10.890000000000004], [39.462352, 10.901344], [39.716101, 10.986124900000004], [39.797684000000004, 11.013382], [39.939293, 11.060696], [40.890828899999995, 11.378615], [40.926699899999996, 11.390599899999998], [41.02237600000001, 10.733179999999999], [41.097593, 10.216341000000003], [41.136446, 9.949368000000002], [41.240848, 9.231984], [41.2409, 9.2316299], [41.20425999999999, 9.220549999999998], [41.166547, 9.209145], [41.02237300000001, 9.165545], [40.941116, 9.140972], [39.939365, 8.83803], [39.810253, 8.798985], [39.77346800000001, 8.787861000000003], [39.73589989999999, 8.776500000000004], [39.73585189999999, 8.776832]], "sceneAreaId": "192_32"}, {"polygon": [[38.230589, 10.503839], [39.462352, 10.901344], [39.5024999, 10.914300000000003], [39.60407300000001, 10.216149000000003], [39.642886, 9.949368999999999], [39.797685, 8.885367000000004], [39.810253, 8.798985], [39.8103, 8.79866], [39.77346800000001, 8.787861000000003], [39.73585189999999, 8.776832], [38.378355, 8.378820000000003], [38.339953, 8.367560999999998], [38.30390000000001, 8.356989999999998], [38.303858, 8.357281], [38.1491349, 9.421203], [38.1111379, 9.682484], [38.072325, 9.949372], [38.0024, 10.430199900000002], [38.03379390000001, 10.440331], [38.14914000000001, 10.477555], [38.230589, 10.503839]], "sceneAreaId": "192_33"}, {"polygon": [[45.449830000000006, 13.6860789], [45.1137999, 15.990899899999993], [45.15210800000001, 16.005916], [46.565254, 16.559847], [46.60339990000001, 16.574799999999996], [46.948415, 14.210086], [46.9485, 14.209500000000004], [46.9073909, 14.195128], [46.8743309, 14.183570999999995], [45.52393, 13.711480000000002], [45.48686200000001, 13.698522000000004], [45.4499, 13.6856], [45.449830000000006, 13.6860789]], "sceneAreaId": "190_28"}, {"polygon": [[42.552997, 13.039798], [42.50615189999999, 13.361464000000002], [42.2751, 14.9479999], [42.310794, 14.960858], [43.727196, 15.4710969], [43.7694, 15.486300000000002], [44.09784, 13.231810999999993], [44.0979, 13.231399900000001], [44.06284000000001, 13.220051], [44.0236329, 13.20736], [43.505051, 13.039493999999998], [42.6701369, 12.769231], [42.62987500000001, 12.756198], [42.5959, 12.7452], [42.595847, 12.745562999999997], [42.591904, 12.772636], [42.552997, 13.039798]], "sceneAreaId": "190_30"}, {"polygon": [[41.16653989999999, 12.299308899999998], [41.09762800000001, 12.772761999999997], [41.05877, 13.0397259], [40.941146, 13.847843000000001], [40.8527, 14.455499899999992], [40.890829000000004, 14.468715000000008], [42.310794, 14.960858], [42.348999899999995, 14.9740999], [42.58758500000002, 13.336017000000004], [42.591855, 13.306703], [42.6307729, 13.0395], [42.6701369, 12.769231], [42.6701999, 12.768799999999995], [42.62987500000001, 12.756198], [42.595847, 12.745562999999997], [42.587585, 12.742981], [42.506076, 12.717508], [41.240855, 12.322106], [41.209086, 12.3121779], [41.1666, 12.2989], [41.16653989999999, 12.299308899999998]], "sceneAreaId": "190_31"}, {"polygon": [[39.735846, 11.866968899999998], [39.716087, 12.00278], [39.60407300000001, 12.772672000000002], [39.565254, 13.039478000000003], [39.428399999999996, 13.980100000000004], [39.462352, 13.991444000000003], [39.716101, 14.0762239], [39.7976839, 14.103482000000001], [39.939293, 14.1507959], [40.890829000000004, 14.468715000000008], [40.926699899999996, 14.4807], [41.022379, 13.823279], [41.097589, 13.306506], [41.13644800000001, 13.0395], [41.240855, 12.322106], [41.2408999, 12.321800000000003], [41.209086, 12.3121779], [41.16653989999999, 12.299308899999998], [41.022377, 12.255706], [40.94111399999999, 12.231127], [39.93942889999999, 11.928159], [39.810258, 11.88909], [39.777527899999995, 11.879190999999997], [39.73589989999999, 11.8666], [39.735846, 11.866968899999998]], "sceneAreaId": "190_32"}, {"polygon": [[38.1491309, 12.511338999999996], [38.1111379, 12.772585999999997], [38.072321, 13.039500000000002], [38.0024, 13.5203], [38.043323, 13.533505999999997], [38.149129, 13.567651000000001], [38.230589, 13.593938999999999], [39.462352, 13.991444000000003], [39.5025, 14.004400000000004], [39.60407200000001, 13.306266000000006], [39.642887999999985, 13.039472899999996], [39.797682999999985, 11.975517899999998], [39.810258, 11.88909], [39.8103, 11.888799899999999], [39.777527899999995, 11.879190999999997], [39.735846, 11.866968899999998], [38.378366, 11.468935000000002], [38.349158, 11.46037], [38.3039, 11.4471], [38.3038469, 11.447463000000004], [38.1491309, 12.511338999999996]], "sceneAreaId": "190_33"}, {"polygon": [[36.666759, 13.1035529], [38.043323, 13.533505999999997], [38.07659999999999, 13.543900000000002], [38.1111379, 13.306413999999998], [38.149956, 13.039500000000004], [38.23059090000001, 12.485044999999998], [38.378366, 11.468935000000002], [38.3783999, 11.468699999999998], [38.349158, 11.46037], [38.3038469, 11.447463000000004], [36.945165, 11.060440000000003], [36.912722, 11.051199], [36.87060000000001, 11.039199999999997], [36.87055500000001, 11.039511900000003], [36.58548100000001, 13.000630900000006], [36.585451, 13.000842], [36.579831, 13.0394989], [36.5747, 13.074799999999998], [36.58545099999999, 13.078157899999999], [36.60653700000001, 13.084743999999997], [36.666759, 13.1035529]], "sceneAreaId": "190_34"}, {"polygon": [[35.471357000000005, 10.651716000000004], [35.4363, 10.642], [35.436266, 10.642235], [35.145500000000006, 12.6424], [35.182100000000005, 12.653481000000001], [36.457099, 13.0395], [36.585482, 13.078369], [36.60653700000001, 13.084743999999997], [36.649, 13.0975999], [36.657447, 13.0395], [36.666759, 12.9754469], [36.945165, 11.060440000000003], [36.94520000000001, 11.060199900000002], [36.912722, 11.051199], [36.87055500000001, 11.039511900000003], [35.510861, 10.662665], [35.471357000000005, 10.651716000000004]], "sceneAreaId": "190_35"}, {"polygon": [[41.16654, 15.389414000000002], [41.09762800000001, 15.862861899999999], [41.05877, 16.129826], [40.9411429, 16.937964], [40.8527, 17.5456], [40.890828899999995, 17.558814900000005], [42.31062, 18.050897999999997], [42.348999899999995, 18.064200000000003], [42.58759700000001, 16.426113], [42.59186000000001, 16.39684], [42.6307789, 16.129644], [42.670151, 15.859335], [42.6701999, 15.858999900000004], [42.638628, 15.8491309], [42.595833999999996, 15.835754], [42.5875999, 15.833179999999999], [42.506089, 15.807702000000006], [41.240855, 15.412211000000001], [41.209017, 15.4022589], [41.1666, 15.389], [41.16654, 15.389414000000002]], "sceneAreaId": "188_31"}, {"polygon": [[39.7358599, 14.957078], [39.716101, 15.092876], [39.604072, 15.862834], [39.565254, 16.129622], [39.4283999, 17.0702], [39.470939, 17.084413], [39.716087, 17.16632], [39.797683, 17.193582], [39.9394289, 17.240941], [40.890828899999995, 17.558814900000005], [40.926699899999996, 17.570800000000006], [41.02237699999999, 16.913393999999997], [41.097589, 16.3966059], [41.13644800000001, 16.1296], [41.240855, 15.412211000000001], [41.24089989999999, 15.411899899999998], [41.209017, 15.4022589], [41.16654, 15.389414000000002], [41.022379, 15.345821000000003], [40.941117, 15.321247999999999], [39.939293, 15.018303999999993], [39.81024500000001, 14.9792809], [39.7672429, 14.966278], [39.7358999, 14.9567999], [39.7358599, 14.957078]], "sceneAreaId": "188_32"}, {"polygon": [[38.149137, 15.601446000000005], [38.111133, 15.862753999999999], [38.0723229, 16.129611899999993], [38.0024, 16.6103999], [38.043062, 16.623524899999996], [38.14913090000001, 16.657761], [38.2305759, 16.684049900000005], [39.470939, 17.084413], [39.5025, 17.0946], [39.60407300000001, 16.396428], [39.642888, 16.129627], [39.7976839, 15.065618000000002], [39.81024500000001, 14.9792809], [39.8103, 14.9788999], [39.7672429, 14.966278], [39.7358599, 14.957078], [38.378353, 14.559126], [38.337793, 14.547235999999995], [38.3039, 14.5373], [38.30386, 14.537572], [38.149137, 15.601446000000005]], "sceneAreaId": "188_33"}, {"polygon": [[36.666759, 16.193653], [38.043062, 16.623524899999996], [38.07659999999999, 16.633999999999997], [38.1111379, 16.396514000000003], [38.14994899999999, 16.129649899999993], [38.230589, 15.575161000000001], [38.378353, 14.559126], [38.3783999, 14.558799999999998], [38.337793, 14.547235999999995], [38.30386, 14.537572], [36.945152, 14.150630999999999], [36.899983, 14.137768], [36.87060000000001, 14.1294], [36.87056900000001, 14.129615999999999], [36.585481, 16.090734999999995], [36.585451, 16.090943], [36.579831, 16.129600900000003], [36.5747, 16.1649], [36.58545100000001, 16.168258], [36.606537, 16.174844000000004], [36.666759, 16.193653]], "sceneAreaId": "188_34"}, {"polygon": [[35.471356899999996, 13.741815900000002], [35.4363, 13.732100000000006], [35.43626600000002, 13.732335000000004], [35.145500000000006, 15.732499999999998], [35.182389, 15.743669], [36.45712, 16.129606], [36.58548100000001, 16.168469], [36.606537, 16.174844000000004], [36.649000000000015, 16.1877], [36.657447, 16.1296], [36.666758, 16.065553], [36.945152, 14.150630999999999], [36.9452, 14.1502999], [36.899983, 14.137768], [36.87056900000001, 14.129615999999999], [35.510861, 13.752764900000004], [35.471356899999996, 13.741815900000002]], "sceneAreaId": "188_35"}, {"polygon": [[39.7358599, 18.047178000000006], [39.716102, 18.182974999999992], [39.604075, 18.952955], [39.565258, 19.2197499], [39.428399999999996, 20.160399999999992], [39.462115000000004, 20.171665], [39.716102, 20.2565249], [39.797699, 20.2837869], [39.939293, 20.331096], [40.890828899999995, 20.649015], [40.926699899999996, 20.661], [41.0223749, 20.0035799], [41.097592, 19.486729000000004], [41.136446, 19.2197499], [41.240842, 18.502402], [41.2408999, 18.5019999], [41.19941800000001, 18.489455900000003], [41.166554, 18.4795179], [41.0223749, 18.43591989999999], [40.941117, 18.411348], [39.939293, 18.1084039], [39.81024500000001, 18.0693809], [39.767243, 18.0563779], [39.7358999, 18.0469], [39.7358599, 18.047178000000006]], "sceneAreaId": "186_32"}, {"polygon": [[46.874327, 9.548360899999999], [46.5298, 11.9101], [46.565254, 11.924647], [47.974685, 12.5029599], [48.01670000000001, 12.5202], [48.371, 10.094284], [48.3711, 10.093599899999997], [48.328004, 10.077886], [48.297028, 10.066591], [46.9484179, 9.574849], [46.909362, 9.560608], [46.8744, 9.547860000000002], [46.874327, 9.548360899999999]], "sceneAreaId": "193_27"}, {"polygon": [[45.449830000000006, 9.050889], [45.1137999, 11.3557], [45.152108, 11.370716000000002], [46.565254, 11.924647], [46.60339999999999, 11.939599899999996], [46.9484179, 9.574849], [46.9485, 9.57429], [46.909362, 9.560608], [46.874327, 9.548360899999999], [45.52393, 9.0762889], [45.486916, 9.0633499], [45.4499, 9.05041], [45.449830000000006, 9.050889]], "sceneAreaId": "193_28"}, {"polygon": [[44.023636, 8.572161000000003], [43.6955, 10.823999999999998], [43.727196, 10.8358969], [45.152108, 11.370716000000002], [45.1875, 11.383999899999996], [45.52393, 9.0762889], [45.52400000000002, 9.075810000000002], [45.486916, 9.0633499], [45.449830000000006, 9.050889], [44.097837, 8.59663], [44.061274, 8.584344], [44.023699900000004, 8.571719900000002], [44.023636, 8.572161000000003]], "sceneAreaId": "193_29"}, {"polygon": [[42.552999, 8.404601], [42.50616, 8.726224], [42.2751, 10.3128], [42.31085, 10.325678000000005], [43.727196, 10.8358969], [43.7694, 10.851100000000002], [44.097837, 8.59663], [44.0979, 8.5962], [44.061274, 8.584344], [44.023636, 8.572161000000003], [43.505051, 8.404302], [42.670142, 8.134051000000001], [42.6325559, 8.1218849], [42.5959, 8.110020000000002], [42.59584300000001, 8.110411000000003], [42.59190789999999, 8.1374289], [42.552999, 8.404601]], "sceneAreaId": "193_30"}, {"polygon": [[41.16654600000001, 7.664104000000001], [41.09763000000001, 8.137581000000004], [41.058774, 8.404529], [40.941147, 9.212669], [40.8527, 9.82033], [40.890088, 9.833287], [42.31085, 10.325678000000005], [42.348999899999995, 10.3388999], [42.58759700000001, 8.700773900000002], [42.591858, 8.6715169], [42.6307789, 8.404302999999999], [42.670142, 8.134051000000001], [42.67019990000001, 8.13365], [42.6325559, 8.1218849], [42.59584300000001, 8.110411000000003], [42.587598, 8.107834], [42.5060849, 8.082358900000001], [41.24085000000001, 7.686935000000003], [41.2052, 7.675794], [41.1666, 7.6637299999999975], [41.16654600000001, 7.664104000000001]], "sceneAreaId": "193_31"}, {"polygon": [[39.73585, 7.231791], [39.71609700000001, 7.367559000000001], [39.60407300000001, 8.137505000000003], [39.565256000000005, 8.4042999], [39.4283999, 9.34492], [39.46577400000002, 9.357406999999995], [39.716097, 9.441043], [39.797688, 9.468304], [39.9393339, 9.515629000000006], [40.890088, 9.833287], [40.926699899999996, 9.845519999999995], [41.022377, 9.188103900000002], [41.097591, 8.671296], [41.1364469, 8.404305000000004], [41.24085000000001, 7.686935000000003], [41.2409, 7.68659], [41.2052, 7.675794], [41.16654600000001, 7.664104000000001], [41.022377, 7.620505], [40.94111800000001, 7.59593], [39.939337, 7.292973], [39.810254, 7.253936000000003], [39.7745, 7.243123], [39.73589989999999, 7.231449900000001], [39.73585, 7.231791]], "sceneAreaId": "193_32"}, {"polygon": [[45.449830000000006, 4.415699], [45.1137999, 6.720549999999999], [45.149778000000005, 6.734652], [46.56525800000001, 7.28945], [46.6034, 7.304399999999999], [46.948417, 4.93966], [46.948499999999996, 4.939089899999999], [46.908669, 4.925166000000002], [46.874328, 4.913162], [45.52393, 4.441099], [45.486934, 4.4281659], [45.4499, 4.41522], [45.449830000000006, 4.415699]], "sceneAreaId": "196_28"}, {"polygon": [[38.2305869, 8.958764999999996], [39.46577400000002, 9.357406999999995], [39.5024999, 9.36926], [39.604074, 8.671099899999998], [39.6428889, 8.404305000000003], [39.79768900000001, 7.340298], [39.810254, 7.253936000000003], [39.8103, 7.25362], [39.7745, 7.243123], [39.73585, 7.231791], [38.3783559, 6.833770999999999], [38.341084, 6.822843], [38.3039, 6.811940000000001], [38.303856, 6.81224], [38.149136, 7.876133000000002], [38.1111379, 8.137414999999997], [38.072324, 8.404305000000003], [38.0024, 8.88512], [38.03942, 8.897068], [38.149136000000006, 8.932477000000004], [38.2305869, 8.958764999999996]], "sceneAreaId": "193_33"}, {"polygon": [[44.023637000000015, 3.936962], [43.6955, 6.188809999999999], [43.72979200000001, 6.201681000000001], [45.149778000000005, 6.734652], [45.1875, 6.7488099], [45.52393, 4.441099], [45.52400000000001, 4.44062], [45.486934, 4.4281659], [45.449830000000006, 4.415699], [44.097836, 3.9614389000000005], [44.0604609, 3.9488809999999996], [44.0237, 3.936529900000002], [44.023637000000015, 3.936962]], "sceneAreaId": "196_29"}, {"polygon": [[45.4498299, 12.140979000000002], [45.1137999, 14.445899999999998], [45.14623300000001, 14.4586109], [46.565262999999995, 15.014752899999996], [46.6034, 15.0297], [46.94841400000001, 12.664991], [46.9485, 12.6644], [46.90724399999999, 12.649976900000002], [46.874331, 12.6384709], [45.52393, 12.166379999999997], [45.486862, 12.153422], [45.4499, 12.1405], [45.4498299, 12.140979000000002]], "sceneAreaId": "191_28"}, {"polygon": [[44.0236329, 11.6622599], [43.6955, 13.9141], [43.73366, 13.928423], [45.14623300000001, 14.4586109], [45.187500000000014, 14.474100000000004], [45.52393, 12.166379999999997], [45.52400000000001, 12.1659], [45.486862, 12.153422], [45.4498299, 12.140979000000002], [44.09784, 11.686711000000003], [44.06284000000001, 11.674951], [44.02369999999999, 11.661799900000002], [44.0236329, 11.6622599]], "sceneAreaId": "191_29"}, {"polygon": [[42.552997, 11.494699000000002], [42.506152, 11.8163639], [42.2751, 13.402900000000006], [42.310806, 13.415764999999995], [43.73366, 13.928423], [43.7694, 13.9413], [44.09784, 11.686711000000003], [44.0979, 11.686299899999998], [44.06284000000001, 11.674951], [44.0236329, 11.6622599], [43.5050509, 11.4943939], [42.670151, 11.224135000000004], [42.638816, 11.213992], [42.5959, 11.2001], [42.5958329, 11.200558999999998], [42.591904, 11.227536], [42.552997, 11.494699000000002]], "sceneAreaId": "191_30"}, {"polygon": [[41.16655400000001, 10.754218000000005], [41.0976349, 11.227712], [41.0587779, 11.494676], [40.941159, 12.302759], [40.8527, 12.910500000000003], [40.882976, 12.920991], [42.310806, 13.415764999999995], [42.349000000000004, 13.429000000000002], [42.58759700000001, 11.790913000000002], [42.5918599, 11.7616409], [42.6307789, 11.494444000000001], [42.670151, 11.224135000000004], [42.6701999, 11.2237999], [42.638816, 11.213992], [42.5958329, 11.200558999999998], [42.5875999, 11.197986], [42.50609, 11.172513], [41.240842, 10.777102], [41.1994179, 10.764156], [41.1666, 10.7539], [41.16655400000001, 10.754218000000005]], "sceneAreaId": "191_31"}]'
            }


            get('/data/sceneareas/{sceneAreaId}') {
                response.contentType = 'application/json'

                params.targetDay //MM-dd
                params.startDate //YYYY-MM-dd
                params.endDate  //YYYY-MM-dd

                send toJson([
                        [sceneId: 'LC81900302015079LGN00', sensor: 'LC8', browseUrl: 'http://earthexplorer.usgs.gov/browse/landsat_8/2015/190/030/LC81900302015079LGN00.jpg', acquisitionDate: '2015-03-20', cloudCover: 0.08, sunAzimuth: 150.48942477, sunElevation: 42.80026465, daysFromTargetDay: 5],
                        [sceneId: 'LC81900302015079LGN00', sensor: 'LC8', browseUrl: 'http://earthexplorer.usgs.gov/browse/landsat_8/2015/190/030/LC81900302015079LGN00.jpg', acquisitionDate: '2015-03-20', cloudCover: 0.08, sunAzimuth: 150.48942477, sunElevation: 42.80026465],
                        [sceneId: 'LE71900302015183NSG00', sensor: 'LE7', browseUrl: 'http://earthexplorer.usgs.gov/browse/etm/190/30/2015/LE71900302015183NSG00.jpg', acquisitionDate: '2015-07-02', cloudCover: 0.09, sunAzimuth: 133.80200195, sunElevation: 63.82229996],
                        [sceneId: 'LE71900302015183NSG00', sensor: 'LE7', browseUrl: 'http://earthexplorer.usgs.gov/browse/etm/190/30/2015/LE71900302015183NSG00.jpg', acquisitionDate: '2015-07-02', cloudCover: 0.09, sunAzimuth: 133.80200195, sunElevation: 63.82229996],
                        [sceneId: 'LE71900302015199NSG00', sensor: 'LE7', browseUrl: 'http://earthexplorer.usgs.gov/browse/etm/190/30/2015/LE71900302015199NSG00.jpg', acquisitionDate: '2015-07-18', cloudCover: 0.1, sunAzimuth: 135.36825562, sunElevation: 61.8910408],
                        [sceneId: 'LE71900302015199NSG00', sensor: 'LE7', browseUrl: 'http://earthexplorer.usgs.gov/browse/etm/190/30/2015/LE71900302015199NSG00.jpg', acquisitionDate: '2015-07-18', cloudCover: 0.1, sunAzimuth: 135.36825562, sunElevation: 61.8910408],
                        [sceneId: 'LE71900302016106NSG00', sensor: 'LE7', browseUrl: 'http://earthexplorer.usgs.gov/browse/etm/190/30/2016/LE71900302016106NSG00.jpg', acquisitionDate: '2016-04-15', cloudCover: 0.34, sunAzimuth: 148.4969635, sunElevation: 53.07840347],
                        [sceneId: 'LE71900302016106NSG00', sensor: 'LE7', browseUrl: 'http://earthexplorer.usgs.gov/browse/etm/190/30/2016/LE71900302016106NSG00.jpg', acquisitionDate: '2016-04-15', cloudCover: 0.34, sunAzimuth: 148.4969635, sunElevation: 53.07840347],
                        [sceneId: 'LE71900302015311NSG00', sensor: 'LE7', browseUrl: 'http://earthexplorer.usgs.gov/browse/etm/190/30/2015/LE71900302015311NSG00.jpg', acquisitionDate: '2015-11-07', cloudCover: 0.47, sunAzimuth: 163.56713867, sunElevation: 29.02179146],
                        [sceneId: 'LE71900302015103NSG00', sensor: 'LE7', browseUrl: 'http://earthexplorer.usgs.gov/browse/etm/190/30/2015/LE71900302015103NSG00.jpg', acquisitionDate: '2015-04-13', cloudCover: 0.47, sunAzimuth: 147.74519348, sunElevation: 51.80644989],
                        [sceneId: 'LE71900302015103NSG00', sensor: 'LE7', browseUrl: 'http://earthexplorer.usgs.gov/browse/etm/190/30/2015/LE71900302015103NSG00.jpg', acquisitionDate: '2015-04-13', cloudCover: 0.47, sunAzimuth: 147.74519348, sunElevation: 51.80644989],
                        [sceneId: 'LE71900302015311NSG00', sensor: 'LE7', browseUrl: 'http://earthexplorer.usgs.gov/browse/etm/190/30/2015/LE71900302015311NSG00.jpg', acquisitionDate: '2015-11-07', cloudCover: 0.47, sunAzimuth: 163.56713867, sunElevation: 29.02179146],
                        [sceneId: 'LE71900302016026NSG00', sensor: 'LE7', browseUrl: 'http://earthexplorer.usgs.gov/browse/etm/190/30/2016/LE71900302016026NSG00.jpg', acquisitionDate: '2016-01-26', cloudCover: 1.02, sunAzimuth: 157.18023682, sunElevation: 24.84968567],
                        [sceneId: 'LE71900302016026NSG00', sensor: 'LE7', browseUrl: 'http://earthexplorer.usgs.gov/browse/etm/190/30/2016/LE71900302016026NSG00.jpg', acquisitionDate: '2016-01-26', cloudCover: 1.02, sunAzimuth: 157.18023682, sunElevation: 24.84968567],
                        [sceneId: 'LC81900302015111LGN00', sensor: 'LC8', browseUrl: 'http://earthexplorer.usgs.gov/browse/landsat_8/2015/190/030/LC81900302015111LGN00.jpg', acquisitionDate: '2015-04-21', cloudCover: 1.4, sunAzimuth: 146.37338078, sunElevation: 54.70757449],
                        [sceneId: 'LC81900302015111LGN00', sensor: 'LC8', browseUrl: 'http://earthexplorer.usgs.gov/browse/landsat_8/2015/190/030/LC81900302015111LGN00.jpg', acquisitionDate: '2015-04-21', cloudCover: 1.4, sunAzimuth: 146.37338078, sunElevation: 54.70757449],
                        [sceneId: 'LC81900302015191LGN00', sensor: 'LC8', browseUrl: 'http://earthexplorer.usgs.gov/browse/landsat_8/2015/190/030/LC81900302015191LGN00.jpg', acquisitionDate: '2015-07-10', cloudCover: 1.76, sunAzimuth: 134.20303675, sunElevation: 62.96916492],
                        [sceneId: 'LC81900302015191LGN00', sensor: 'LC8', browseUrl: 'http://earthexplorer.usgs.gov/browse/landsat_8/2015/190/030/LC81900302015191LGN00.jpg', acquisitionDate: '2015-07-10', cloudCover: 1.76, sunAzimuth: 134.20303675, sunElevation: 62.96916492],
                        [sceneId: 'LC81900302015015LGN00', sensor: 'LC8', browseUrl: 'http://earthexplorer.usgs.gov/browse/landsat_8/2015/190/030/LC81900302015015LGN00.jpg', acquisitionDate: '2015-01-15', cloudCover: 1.85, sunAzimuth: 158.23985381, sunElevation: 22.88232301],
                        [sceneId: 'LC81900302015015LGN00', sensor: 'LC8', browseUrl: 'http://earthexplorer.usgs.gov/browse/landsat_8/2015/190/030/LC81900302015015LGN00.jpg', acquisitionDate: '2015-01-15', cloudCover: 1.85, sunAzimuth: 158.23985381, sunElevation: 22.88232301],
                        [sceneId: 'LC81900302015239LGN00', sensor: 'LC8', browseUrl: 'http://earthexplorer.usgs.gov/browse/landsat_8/2015/190/030/LC81900302015239LGN00.jpg', acquisitionDate: '2015-08-27', cloudCover: 2.28, sunAzimuth: 146.90510045, sunElevation: 52.77744787],
                        [sceneId: 'LC81900302015239LGN00', sensor: 'LC8', browseUrl: 'http://earthexplorer.usgs.gov/browse/landsat_8/2015/190/030/LC81900302015239LGN00.jpg', acquisitionDate: '2015-08-27', cloudCover: 2.28, sunAzimuth: 146.90510045, sunElevation: 52.77744787],
                        [sceneId: 'LC81900302015127LGN00', sensor: 'LC8', browseUrl: 'http://earthexplorer.usgs.gov/browse/landsat_8/2015/190/030/LC81900302015127LGN00.jpg', acquisitionDate: '2015-05-07', cloudCover: 2.78, sunAzimuth: 143.40108505, sunElevation: 59.2340895],
                        [sceneId: 'LC81900302015127LGN00', sensor: 'LC8', browseUrl: 'http://earthexplorer.usgs.gov/browse/landsat_8/2015/190/030/LC81900302015127LGN00.jpg', acquisitionDate: '2015-05-07', cloudCover: 2.78, sunAzimuth: 143.40108505, sunElevation: 59.2340895],
                        [sceneId: 'LC81900302016050LGN00', sensor: 'LC8', browseUrl: 'http://earthexplorer.usgs.gov/browse/landsat_8/2016/190/030/LC81900302016050LGN00.jpg', acquisitionDate: '2016-02-19', cloudCover: 2.98, sunAzimuth: 153.68447136, sunElevation: 31.61607965]
                ])
            }






            get('/foo/{name}') {

                LOG.info("adasdasdfasfas")

                response.contentType = 'application/json'
                send toJson(
                        foo: params.name,
                        bar: params
                )
            }

        }
        return controller
    }

    static void main(String[] args) {
        new Server().deploy(this, 9999)
    }

}
