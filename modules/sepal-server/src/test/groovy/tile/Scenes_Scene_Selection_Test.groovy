package tile

import org.openforis.sepal.component.datasearch.internal.Scene
import org.openforis.sepal.component.datasearch.internal.Scenes
import spock.lang.Ignore
import spock.lang.Specification

@Ignore
class Scenes_Scene_Selection_Test extends Specification {
    static final List<List<Double>> SQUARE = [[0d, 0d], [1d, 0d], [1d, 1d], [0d, 1d], [0d, 0d]]
    static final List<List<Double>> BOTTOM_HALF = [[0d, 0d], [1d, 0d], [1d, 0.5d], [0d, 0.5d], [0d, 0d]]
    static
    final List<List<Double>> TOP_HALF = [[0d, 0.5000001d], [1d, 0.5000001d], [1d, 1d], [0d, 1d], [0d, 0.5000001d]]
    static final List<List<Double>> ROTATED = [[0d, 0.5d], [0.5d, 0d], [1d, 0.5d], [0.5d, 1d], [0d, 0.5d]]

    int sceneIndex
    def scoreInvocations = []
    def spyingScore = new Scenes.ScoringAlgorithm() {
        double score(Scene scene, double improvement) {
            scoreInvocations << [scene: scene, improvement: improvement]
            return improvement
        }
    }

    def 'Given one scene, scene is returned'() {
        def scene = scene()

        expect:
        selectScenes([scene]) == [scene]
    }

    def 'Given scene with complete coverage and no clouds, improvement is 1'() {
        when:
        selectScenes([scene()])

        then:
        firstImprovement() == 1d
    }

    def 'Given scene covering bottom half and no clouds, improvement is 0.5'() {
        def scene = scene(footprint: BOTTOM_HALF)

        when:
        selectScenes([scene])

        then:
        firstImprovement() == 0.5d
    }

    def 'Given rotated tile and scene covering bottom half and no clouds, improvement is about 0.5'() {
        when:
        selectScenes(footprint: ROTATED, [scene(footprint: BOTTOM_HALF)])

        then:
        inRange firstImprovement(), 0.45, 0.55
    }

    def 'Given scene covering bottom half and 75% cloud cover, improvement is 0.125'() {
        when:
        selectScenes([scene(footprint: BOTTOM_HALF, cloudCover: 0.75d)])

        then:
        firstImprovement() == 0.125d
    }

    def 'Given two scenes covering bottom half and no clouds, first two improvements is 0.5 and third is 0'() {
        when:
        selectScenes([scene(footprint: BOTTOM_HALF), scene(footprint: BOTTOM_HALF)])

        then:
        improvements() == [0.5d, 0.5d, 0d]
    }

    def 'Given two scenes with full coverage no clouds, only one scene is selected'() {
        def firstScene = scene()
        def secondScene = scene()

        when:
        def selection = selectScenes([firstScene, secondScene])

        then:
        selection == [firstScene] || selection == [secondScene]
    }

    def 'Given bottom half scene scene and top half scene and no clouds, both scenes are selected'() {
        def firstScene = scene(footprint: BOTTOM_HALF)
        def secondScene = scene(footprint: TOP_HALF)

        when:
        def selection = selectScenes([firstScene, secondScene])

        then:
        containsSame selection, [firstScene, secondScene]
    }

    def 'Given bottom half scene scene and top half scene with no clouds and min coverage 0.5, first scene is selected'() {
        def firstScene = scene(footprint: BOTTOM_HALF)
        def secondScene = scene(footprint: TOP_HALF)

        when:
        def selection = selectScenes(minCoverage: 0.5d, [firstScene, secondScene])

        then:
        selection == [firstScene] || selection == [secondScene]
    }

    def 'Given two complete, cloud free scenes, and min scene is 2, , both scenes are selected'() {
        def firstScene = scene()
        def secondScene = scene()

        when:
        def selection = selectScenes(minScenes: 2, [firstScene, secondScene])

        then:
        containsSame selection, [firstScene, secondScene]
    }

    def 'Given two partial scenes, and max scenes is 1, only first scene is included'() {
        def firstScene = scene(footprint: BOTTOM_HALF)
        def secondScene = scene(footprint: BOTTOM_HALF)

        when:
        def selection = selectScenes(maxScenes: 1, [firstScene, secondScene])

        then:
        selection == [firstScene] || selection == [secondScene]
    }

    def 'Given a cloudy and cloud free scene, only the cloud free scene is included'() {
        def cloudy = scene(cloudCover: 1d)
        def cloudFree = scene(cloudCover: 0d)

        when:
        def selection = selectScenes([cloudy, cloudFree])

        then:
        selection == [cloudFree]
    }

    def 'Given complete scene with cloud-cover of 33%, improvement is 0.67'() {
        when:
        selectScenes([scene(cloudCover: 0.33d)])

        then:
        inRange firstImprovement(), 0.669d, 0.671
    }

    def 'Given half scene with cloud-cover of 33%, improvement is 0.33'() {
        when:
        selectScenes([scene(cloudCover: 0.33d, footprint: BOTTOM_HALF)])

        then:
        inRange firstImprovement(), 0.32, 0.34
    }

    def 'Given three scenes with half cloud cover, improvements are 0.5d, 0.5d, 0.5d, 0.25d, 0.25, 0.125'() {
        when:
        selectScenes([
                scene(cloudCover: 0.5d),
                scene(cloudCover: 0.5d),
                scene(cloudCover: 0.5d)
        ])

        then:
        improvements() == [0.5d, 0.5d, 0.5d, 0.25d, 0.25, 0.125]
    }

    // TODO: Include scenes not improving coverage (two cloud-free bottom scenes?)

//    @Timeout(1)
    def 'Given many scenes, selecting them takes less than a second'() {
        def count = 1000
        def scenes = []
        count.times {
            scenes << scene(cloudCover: 1, footprint: BOTTOM_HALF)
        }

        expect:
        def start = System.currentTimeMillis()
//        1000.times {
        selectScenes(scenes).size() == count
//        }
        println(System.currentTimeMillis() - start)
    }


    def 'Test'() {
        def tile = new Scenes([[-77.6952059d, -0.08838420000000004d], [-76.70920589999999d, -0.08844310000000004d], [-76.7094155d, 0.9045062d], [-77.6955362d, 0.9039036999999995d], [-77.6952059d, -0.08838420000000004d]])
        def sceneData = [
                [2.7903, [[-76.70938552083159, -0.08835220937365572], [-76.70929552620858, -0.08828262077779536], [-76.70933659967426, 0.4081222882656975], [-76.70950516552598, 0.9045061476782632], [-76.70957479805233, 0.9045961154526054], [-76.92750517623953, 0.9044861708195415], [-76.92806476066534, 0.9027933219123112], [-76.93021696764659, 0.8941080622105475], [-76.9401665389342, 0.8525992820552625], [-76.95926085122451, 0.7725674248986666], [-76.96302592066593, 0.7557469375304157], [-76.96759771477701, 0.7351291446027979], [-77.02947109931735, 0.4554447807670157], [-77.04319621957822, 0.39332559567765435], [-77.14094924398543, -0.05070049168034211], [-77.14633857376585, -0.07538233856890447], [-77.14876590399145, -0.08678325625926854], [-77.14876598636495, -0.0882309922359012], [-77.1476922687331, -0.08832932358961738], [-76.70938552083159, -0.08835220937365572]]],
                [86, [[-76.73020446078476, 0.9045377487771171], [-76.73023750056852, 0.9045862564614053], [-77.69553626275555, 0.9039937196118255], [-77.69557770309825, 0.9039571221629467], [-77.69562620837374, 0.9039240811997865], [-77.69546829926149, 0.6558771960244861], [-77.69536062727619, 0.4078504538252646], [-77.69530316945585, 0.1598235414110291], [-77.69529592048359, -0.08820344680000186], [-77.69525935255231, -0.08824490844493606], [-77.6952263458109, -0.0882934313416937], [-76.9472327420047, -0.08834043559642367], [-76.94719787891547, -0.08830969254984852], [-76.9471540728257, -0.08829414912454525], [-76.94714569122127, -0.08827327159352642], [-76.9343896774453, -0.03962592433262516], [-76.89774775424603, 0.12096644328275732], [-76.86112037519294, 0.2859049253986467], [-76.74056521106745, 0.8491295662209805], [-76.73016709299677, 0.9028598876838304], [-76.73016786746891, 0.9044963005823813], [-76.73020446078476, 0.9045377487771171]]],
                [17, [[-76.7093855208315, -0.08835220937365572], [-76.70929552620858, -0.08828262077779432], [-76.70933659967426, 0.4081222882656975], [-76.70950516552598, 0.9045061476782632], [-76.70957479805145, 0.9045961154524037], [-76.91671663749102, 0.9044919234467332], [-76.91728430628434, 0.9033475682787493], [-76.93100143769585, 0.8466357578422127], [-76.93557286682967, 0.8265593113864564], [-76.96381070049026, 0.7012236468941447], [-76.97214871523317, 0.6635151810215243], [-77.03322554928253, 0.387089369474807], [-77.11804812130383, 0.002189206414680273], [-77.13259790126857, -0.0639910180919896], [-77.13717967606202, -0.08487880114203615], [-77.13745056230646, -0.08678701998636841], [-77.13745064359199, -0.08822319489074153], [-77.1369206072819, -0.08832994833905829], [-76.7093855208315, -0.08835220937365572]]],
                [31, [[-76.70950516552598, 0.9045061476782632], [-76.70957479805156, 0.9045961154524337], [-76.91831520696229, 0.9044910730962472], [-76.91862738682607, 0.9041764965531066], [-76.92266881443297, 0.8897734825454588], [-76.92347605766535, 0.8865159393770936], [-76.92562733164435, 0.8772911148692493], [-76.93019848456213, 0.8574863716724027], [-76.93557651732499, 0.8341548709553487], [-76.96300743148484, 0.7134306743240759], [-77.03322738380628, 0.3946842593945946], [-77.07522328994298, 0.20399198473517596], [-77.13637019312934, -0.07375537984884925], [-77.13879621275777, -0.08515021490446831], [-77.13906706013333, -0.08705815694482254], [-77.13906712681406, -0.08823357720630585], [-77.13763309135801, -0.08832990711222745], [-76.7092955204504, -0.08835221354196829], [-76.70933659967426, 0.4081222882656975], [-76.70950516552598, 0.9045061476782632]]],
                [74, [[-77.69553626275555, 0.9039937196118255], [-77.69562620837374, 0.9039240811997865], [-77.69546829926149, 0.6558771960244861], [-77.69536062727619, 0.4078504538252646], [-77.69530316945585, 0.1598235414110291], [-77.69529592048359, -0.08820344680000186], [-77.6952263458109, -0.0882934313416926], [-76.94806894207309, -0.08834039150594604], [-76.947147688007, -0.08592936280405314], [-76.94516977588476, -0.07977565266565441], [-76.94409087155044, -0.07543180304231202], [-76.85896625516594, 0.29458535748011655], [-76.8245061417047, 0.44867912663694864], [-76.76476823013026, 0.7243252691139063], [-76.7301667510309, 0.9021363894027502], [-76.73016786746891, 0.9044963005653359], [-76.73023750056852, 0.9045862564614042], [-77.69553626275555, 0.9039937196118255]]],
                [23, [[-77.13502591228233, -0.08814965946420647], [-77.13496194691386, -0.08823819255218575], [-77.13350188500635, -0.08833014596609519], [-76.70938552083147, -0.08835220937365572], [-76.70929552620858, -0.08828262077779749], [-76.70933659967426, 0.4081222882656975], [-76.70950516552598, 0.9045061476782632], [-76.70957479805124, 0.904596115452364], [-76.91456605940223, 0.9044930663135776], [-76.91512917911493, 0.9030737879211583], [-76.93099692517775, 0.8374126811514963], [-76.96380677042714, 0.6917295949045223], [-77.02864784765984, 0.3984829033066242], [-77.03779908519698, 0.35697984825112733], [-77.10808010875373, 0.036907161586500994], [-77.13259842120222, -0.07511154834091176], [-77.13502580473184, -0.08624135475526899], [-77.13502591228233, -0.08814965946420647]]],
                [82, [[-77.69562339709681, 0.9039259961935402], [-77.69562620017786, 0.9039112077241643], [-77.69546829926149, 0.6558771960244861], [-77.69536062727619, 0.4078504538252646], [-77.69530316945585, 0.1598235414110291], [-77.69529592048359, -0.08820344680000186], [-77.69525935255231, -0.08824490844493493], [-77.69522634581085, -0.08829343134170008], [-76.94310123140227, -0.08834065317926652], [-76.9430667055979, -0.08831020755112436], [-76.94302312939134, -0.08829537234511088], [-76.94301448062532, -0.0882746040651592], [-76.94211560407922, -0.08501749123622877], [-76.84819364781848, 0.32931112879300556], [-76.76476545229934, 0.7167284949982858], [-76.7251366234801, 0.9037658095030009], [-76.72513696950878, 0.9044987118570814], [-76.72517356277176, 0.9045401600870981], [-76.72520660248331, 0.9045886678103237], [-77.69553626275514, 0.9039937196118257], [-77.6955777030981, 0.9039571221630442], [-77.69562339709681, 0.9039259961935402]]],
                [100, [[-76.70950516552598, 0.9045061476782632], [-76.70957479805061, 0.9045961154522182], [-76.90673825895998, 0.9044972153512432], [-76.90731203802619, 0.9036298687181796], [-76.90812263735462, 0.9003587407510282], [-76.9126940554119, 0.8810959276215279], [-76.92103034477672, 0.8458269169755427], [-76.93017366812637, 0.8064888855757109], [-76.94926908876268, 0.7240162292486557], [-76.95464856902777, 0.7004138376969292], [-76.96298674619348, 0.6627050558050546], [-77.02406433359504, 0.38573527663797175], [-77.0431759825473, 0.2986607898810228], [-77.06686942978442, 0.19070216938883533], [-77.12802110744057, -0.08786907395094758], [-77.12802112806429, -0.08823281835447777], [-77.12685725042353, -0.0883305291700198], [-76.7092955204504, -0.08835221354189285], [-76.70933659967426, 0.4081222882656975], [-76.70950516552598, 0.9045061476782632]]],
                [30, [[-76.70950516552598, 0.9045061476782632], [-76.70957479805061, 0.9045961154522182], [-76.90673825895998, 0.9044972153512432], [-76.90731203802619, 0.9036298687181796], [-76.90812263735462, 0.9003587407510282], [-76.9126940554119, 0.8810959276215279], [-76.92103034477672, 0.8458269169755427], [-76.93017366812637, 0.8064888855757109], [-76.94926908876268, 0.7240162292486557], [-76.95464856902777, 0.7004138376969292], [-76.96298674619348, 0.6627050558050546], [-77.02406433359504, 0.38573527663797175], [-77.0431759825473, 0.2986607898810228], [-77.06686942978442, 0.19070216938883533], [-77.12802110744057, -0.08786907395094758], [-77.12802112806429, -0.08823281835447777], [-77.12685725042353, -0.0883305291700198], [-76.7092955204504, -0.08835221354189285], [-76.70933659967426, 0.4081222882656975], [-76.70950516552598, 0.9045061476782632]]],
                [100, [[-76.70950516552598, 0.9045061476782632], [-76.70957479805088, 0.9045961154522777], [-76.90998874171495, 0.9044954945344422], [-76.91054833979985, 0.9028026315545177], [-76.91270070140973, 0.8941169251765803], [-76.93098617518599, 0.814897252280716], [-76.9334063870503, 0.804045208982533], [-76.95841752819051, 0.69173175954997], [-76.96756278976913, 0.6504966833393491], [-77.03321800110692, 0.3539972080827129], [-77.09434108480859, 0.076236902414074], [-77.12721006568705, -0.07321336884467888], [-77.12963625491562, -0.08460903254910616], [-77.12990695443503, -0.08678823624751643], [-77.12990703538978, -0.08822363020729426], [-77.12937699684073, -0.08833038399408058], [-76.7092955204504, -0.08835221354190936], [-76.70933659967426, 0.4081222882656975], [-76.70950516552598, 0.9045061476782632]]],
                [99.1738, [[-76.72104102937541, 0.9045421355542315], [-76.72107406903133, 0.9045906433148463], [-77.69553626275479, 0.9039937196118262], [-77.695577703098, 0.9039571221631134], [-77.69562620837374, 0.9039240811997885], [-77.69546829926149, 0.6558771960244861], [-77.69536062727619, 0.4078504538252646], [-77.69530316945585, 0.1598235414110291], [-77.69529592048359, -0.08820344680000186], [-77.69525935255228, -0.08824490844496306], [-77.69522634581081, -0.08829343134170706], [-76.93896971062433, -0.08834087030067361], [-76.93893515605899, -0.08831039930361564], [-76.93889155980285, -0.08829550407698296], [-76.93888293374249, -0.08827472635605817], [-76.93654672631432, -0.07977316476612457], [-76.85788478997242, 0.27234122821609], [-76.77928483009671, 0.6244849533502712], [-76.74054822507314, 0.8100629980713254], [-76.72100409102674, 0.9037679275875127], [-76.72100443615955, 0.904500687283133], [-76.72104102937541, 0.9045421355542315]]],
                [30.6682, [[-77.12583298383348, -0.08818739835391941], [-77.12581083063539, -0.08823556138017623], [-77.12524448399557, -0.08833062200008615], [-76.70938552083142, -0.08835220937365575], [-76.70929552620856, -0.08828262077779533], [-76.70933659967426, 0.4081222882656975], [-76.70950516552598, 0.9045061476782632], [-76.70957479805047, 0.9045961154521918], [-76.90534248538981, 0.9044979533720336], [-76.90537566120503, 0.9044686675202387], [-76.90542148576588, 0.904455582010719], [-76.90596651515767, 0.9028067982998857], [-76.9073126843736, 0.8981906331482319], [-76.92721244994723, 0.812729112336319], [-76.95921725531832, 0.670301974468808], [-77.0286379323859, 0.3556256766122823], [-77.12424675387368, -0.0786381335930239], [-77.12586569018052, -0.08624209689179152], [-77.12586579725777, -0.08815018726296353], [-77.12583298383348, -0.08818739835391941]]],
                [100, [[-77.69553626275471, 0.9039937196118264], [-77.69562620837374, 0.9039240811997883], [-77.69546829926149, 0.6558771960244861], [-77.69536062727619, 0.4078504538252646], [-77.69530316945585, 0.1598235414110291], [-77.69529592048359, -0.08820344680000186], [-77.6952263458108, -0.08829343134170847], [-76.93801576954152, -0.08834092037019546], [-76.93726822921064, -0.08683595985417164], [-76.9363671141145, -0.08338935199576301], [-76.91714400910624, 0.0037783747484448583], [-76.86057763682253, 0.2609475529478501], [-76.7699598643165, 0.6740433006912409], [-76.76081266285, 0.7160062225706687], [-76.75005219730448, 0.7653854373054118], [-76.72010528767794, 0.9028636344019366], [-76.72010605815032, 0.9045011160762256], [-76.72017569099978, 0.9045910721461796], [-77.69553626275471, 0.9039937196118264]]],
                [7.6298, [[-77.13287060063237, -0.0882311677642145], [-77.131887086616, -0.088330239203371], [-76.70929552045041, -0.08835221354192743], [-76.70933659967426, 0.4081222882656975], [-76.70950519609256, 0.9045961484750011], [-76.91187899257478, 0.9044944924807116], [-76.91305622565598, 0.9001404019586553], [-76.94470567746262, 0.7641651648139853], [-76.95385034855008, 0.7248280995121648], [-76.95627108938149, 0.71424767181296], [-76.95842288149403, 0.7047523751549899], [-76.96299531128157, 0.6841345376243895], [-77.03779660524553, 0.34558754634175887], [-77.06768011026442, 0.20996028908300937], [-77.1134680253245, 0.002189213012856084], [-77.12801786449627, -0.06399129433030554], [-77.13254561491304, -0.08482435032098364], [-77.13287051902628, -0.08678623480317149], [-77.13287060063237, -0.0882311677642145]]],
                [100, [[-76.72351989231716, 0.9044994854134344], [-76.72358952525147, 0.9045894413973854], [-77.69562625266623, 0.9039936524107323], [-77.69546829926149, 0.6558771960244861], [-77.69536062727619, 0.4078504538252646], [-77.69530316945585, 0.1598235414110291], [-77.69529591785381, -0.08829342626977142], [-76.94214729252857, -0.08834070335531873], [-76.94139905109692, -0.08683433178644172], [-76.93798293495897, -0.07163303952508014], [-76.9263054125989, -0.01882711872828328], [-76.91301292790644, 0.04139406386622749], [-76.86722267124124, 0.24919129720711708], [-76.75418352158317, 0.762851563506004], [-76.73840316121138, 0.8350221153121157], [-76.72603152216865, 0.8919996580518433], [-76.72513504877321, 0.8961601367707186], [-76.7235195466022, 0.9037665606955146], [-76.72351989231716, 0.9044994854134344]]],
                [98.9823, [[-77.69529592048359, -0.08820344680000186], [-77.69522634581081, -0.08829343134170706], [-76.9389011886447, -0.088340873901773], [-76.93798413990716, -0.08501791205816649], [-76.93546825094133, -0.07416517683384294], [-76.844782108799, 0.338535322760765], [-76.75417886851507, 0.7512764863868442], [-76.73839804424247, 0.8232660261428631], [-76.72925337559884, 0.8652303016170823], [-76.72763964809728, 0.8726466143617746], [-76.72261958271478, 0.8961614123275053], [-76.72100409094857, 0.9037677616038229], [-76.72100443615955, 0.904500687283133], [-76.72107406903133, 0.9045906433148463], [-77.69562625266622, 0.9039936524109394], [-77.69546829926149, 0.6558771960244861], [-77.69536062727619, 0.4078504538252646], [-77.69530316945585, 0.1598235414110291], [-77.69529592048359, -0.08820344680000186]]],
                [99.2989, [[-76.71525525124201, 0.9044917995737088], [-76.71531816673507, 0.9045933869629433], [-77.69562625266623, 0.9039936524114127], [-77.69546829926149, 0.6558771960244861], [-77.69536062727619, 0.4078504538252646], [-77.69530316945585, 0.1598235414110291], [-77.69529591785381, -0.08829342626983086], [-76.93388423640526, -0.08834113692362731], [-76.93313669447606, -0.08683617277548612], [-76.93223565234436, -0.08338984249401678], [-76.92882159131555, -0.06837836677483115], [-76.91714408217236, -0.015571997143015735], [-76.84226451918828, 0.324610165245812], [-76.83562336412233, 0.354813811303892], [-76.75667980668347, 0.7143799542501718], [-76.74089778251874, 0.7863690774953215], [-76.72511788954007, 0.858540223311999], [-76.72350412594193, 0.8659565516155033], [-76.71525525124201, 0.9044917995737088]]],
                [100, [[-76.70954865656557, 0.6765636269158899], [-76.70950289180794, 0.676591566117355], [-76.70941257705603, 0.6784228633794431], [-76.70950516552833, 0.9045061539707463], [-76.70957479805116, 0.9045961154523436], [-76.9134270378053, 0.9044936710844768], [-76.91346021354818, 0.9044643851645909], [-76.91350603807435, 0.9044512995669749], [-76.91432089235745, 0.9019862440577834], [-76.91647291493216, 0.8927579764322598], [-76.95385276139797, 0.7302529606187295], [-76.95627552713688, 0.7193915238569925], [-76.95627529187371, 0.7188390711148236], [-76.95624351637967, 0.7188030748361678], [-76.95622418840355, 0.7187554311491435], [-76.95242991192208, 0.7179386665895927], [-76.72334985615664, 0.676522499373099], [-76.71759228434756, 0.6758000903963175], [-76.71686351646551, 0.67580034984841], [-76.70958283616108, 0.6765268372327018], [-76.70954865656557, 0.6765636269158899]]],
                [99.175, [[-76.9131369994544, 0.8895732965562685], [-76.91557027313222, 0.8898441624295006], [-76.91726344050699, 0.8898432768526856], [-76.92104432608595, 0.8737671870496958], [-76.93018707213798, 0.8344290166658818], [-76.9355653789876, 0.8110976276113828], [-76.94995216406079, 0.7484930015522016], [-76.95385318409699, 0.7310664227665108], [-77.01949615578394, 0.4348326312463802], [-77.03779795518066, 0.3518261798023386], [-77.0493730369946, 0.29920214028006087], [-77.13179027168317, -0.07619669931611088], [-77.13435115487287, -0.08822489099769168], [-77.13278363405978, -0.08833018744607313], [-76.70929552106521, -0.08835221354190499], [-76.70933120433502, 0.38171597978849375], [-76.70948176371418, 0.8535578379957756], [-76.71368770058427, 0.8544026385498918], [-76.72527866308094, 0.8565679752744868], [-76.85599777874177, 0.8795649912591077], [-76.9131369994544, 0.8895732965562685]]],
                [98.8354, [[-77.69553626275535, 0.9039937196118255], [-77.69562620837374, 0.9039240811997923], [-77.69546829926149, 0.6558771960244861], [-77.69536062727619, 0.4078504538252646], [-77.69530316945585, 0.1598235414110291], [-77.69529592048359, -0.08820344680000186], [-77.69522634581088, -0.08829343134169565], [-76.9464824869882, -0.0883404751441908], [-76.94553699240768, -0.08757906402190554], [-76.94463036103821, -0.08429384662334508], [-76.86812225573492, 0.2587761624625031], [-76.79992821905121, 0.5715772705098353], [-76.73177754809021, 0.8844007607160831], [-76.72926754590918, 0.8961582586045456], [-76.7276520736232, 0.9037645839714694], [-76.72765242016608, 0.9044975071070102], [-76.72772205320315, 0.9045874630124909], [-77.69553626275535, 0.9039937196118255]]],
                [97.3949, [[-76.92724393214984, 0.8767477670990911], [-76.93100844046724, 0.8604697634484927], [-76.94472239368142, 0.800242498864796], [-76.95843781923901, 0.7397450342041488], [-76.96838925792191, 0.6957967781451927], [-76.97376877788007, 0.6719237175694494], [-77.0020149480248, 0.5446946414402491], [-77.02488678741297, 0.4416124485577475], [-77.03780508075832, 0.3832908117913506], [-77.06607005929199, 0.25471533738518776], [-77.08518777689483, 0.16764466676129192], [-77.10808095184767, 0.06321689422745463], [-77.12262823024902, -0.0032355514900852637], [-77.14095295410809, -0.08705468263634487], [-77.14095302650347, -0.08832971487960263], [-76.70929552045041, -0.08835221354197942], [-76.70933659967426, 0.4081222882656975], [-76.70950519609256, 0.9045961484756668], [-76.92008294942912, 0.9044901319629214], [-76.9245959804738, 0.8881023838066195], [-76.92724393214984, 0.8767477670990911]]],
                [89.0509, [[-77.69553626275587, 0.9039937196118254], [-77.69562620837374, 0.9039240811997898], [-77.69546829926149, 0.6558771960244861], [-77.69536062727619, 0.4078504538252646], [-77.69530316945585, 0.1598235414110291], [-77.69529592048359, -0.08820344680000186], [-77.69522634581092, -0.08829343134168605], [-76.95129386691904, -0.0883402212741981], [-76.94965963761918, -0.08176066860586152], [-76.94462878401316, -0.05915458468141958], [-76.82666884379009, 0.47580668907008977], [-76.747567784353, 0.8382735099224099], [-76.73842353245033, 0.8802377786935387], [-76.73358090701039, 0.9028573530590009], [-76.73358168343434, 0.9044946603806804], [-76.73365131661883, 0.9045846161949267], [-77.69553626275587, 0.9039937196118254]]],
                [100, [[-76.92264527360616, 0.9044887661939619], [-76.92294280354659, 0.9038889773776342], [-76.92429020173164, 0.8992685088573685], [-76.92751832411696, 0.8876009217508528], [-76.93020797709544, 0.8770190435711342], [-76.93262852500733, 0.8672514384234823], [-76.93510327747589, 0.8566398787959878], [-76.97216041366511, 0.6925399253842779], [-77.03780819790235, 0.3963107039353407], [-77.05772672774982, 0.3062529970513297], [-77.07522640335083, 0.22704743498670715], [-77.14095014305671, -0.07131425171304735], [-77.14418589481899, -0.0867836807199587], [-77.14418598258735, -0.08832952731753305], [-76.7092955204504, -0.0883522135420077], [-76.70933659967426, 0.4081222882656975], [-76.70950519609256, 0.9045961484758916], [-76.92264527360616, 0.9044887661939619]]],
                [79.2089, [[-77.69553626275606, 0.9039937196118254], [-77.69562620837374, 0.9039240811997891], [-77.69546829926149, 0.6558771960244861], [-77.69536062727619, 0.4078504538252646], [-77.69530316945585, 0.1598235414110291], [-77.69529592048359, -0.08820344680000186], [-77.69522634581094, -0.08829343134168385], [-76.95382434453052, -0.08834008750137098], [-76.95163874916176, -0.08412332967189366], [-76.93438927302596, -0.01792467157553745], [-76.84954649218378, 0.3575232724088812], [-76.76477154201767, 0.7330067736836694], [-76.74057280329257, 0.8675815345483469], [-76.73609557533388, 0.9012319491417036], [-76.73609712281093, 0.9044934497062204], [-76.73616675605798, 0.9045834055112166], [-77.69553626275606, 0.9039937196118254]]],
                [23.9414, [[-77.14337599145712, -0.08460648464042832], [-77.14364703895419, -0.08624316480611725], [-77.14364715701619, -0.08832955860454184], [-76.7092955204504, -0.08835221354200215], [-76.70933659967426, 0.4081222882656975], [-76.70950519609256, 0.9045961484758916], [-76.92286337918947, 0.9044886499001265], [-76.92429033748671, 0.8998115749924687], [-76.92751867704493, 0.888143190316736], [-76.93020838638766, 0.8772892167016254], [-76.9492630061983, 0.7936249696498815], [-76.9661527010146, 0.7182160463357166], [-76.97753936617822, 0.6673108071465431], [-76.98668502497468, 0.6263475520352794], [-77.03323290496468, 0.416926688010997], [-77.03780820126129, 0.3963106888463418], [-77.04319115419564, 0.37189717060645483], [-77.05691908070388, 0.3095079686176071], [-77.13178865709109, -0.0314434262656991], [-77.1409502058384, -0.07321273503404513], [-77.14337599145712, -0.08460648464042832]]],
                [82.8245, [[-77.69553626275592, 0.9039937196118254], [-77.69562620837374, 0.9039240811997855], [-77.69546829926149, 0.6558771960244861], [-77.69536062727619, 0.4078504538252646], [-77.69530316945585, 0.1598235414110291], [-77.69529592048359, -0.08820344680000186], [-77.69522634581095, -0.08829343134168283], [-76.95310742143042, -0.08834012541851277], [-76.95217838473273, -0.08665679742846447], [-76.95127662318512, -0.08338922134749292], [-76.90206031695304, 0.1394127845810527], [-76.87189733143973, 0.276137126100555], [-76.75671415550966, 0.7997461087876409], [-76.74505911292536, 0.8534673623233672], [-76.73519836805352, 0.9003170969157575], [-76.73448067925737, 0.9044828680578544], [-76.73454633027707, 0.9045841856279601], [-77.69553626275592, 0.9039937196118254]]],
                [85.6868, [[-76.94809787480187, -0.08831127017391348], [-76.9480521829396, -0.0882985615775456], [-76.94516964335624, -0.0797754366200342], [-76.90852355115878, 0.08190331881734206], [-76.7900639600348, 0.6233959936144567], [-76.730167531854, 0.9003192568493725], [-76.72944979282842, 0.9044852853220228], [-76.72951544370837, 0.9045866029833297], [-77.69553626275551, 0.9039937196118257], [-77.69562620684492, 0.903924087959058], [-77.69538359711213, 0.47183405361555325], [-77.6952933909467, 0.03976382927380968], [-77.69526538148841, 0.03973208290336783], [-77.69525520957221, 0.039687490809419024], [-77.69200246473929, 0.03841413075142969], [-77.6823022303263, 0.03515925613882728], [-77.21362136375735, -0.08524978056166038], [-77.19744904648768, -0.08796430232643006], [-77.19169431918168, -0.08832673888931118], [-76.94813089513076, -0.0883403882347469], [-76.94809787480187, -0.08831127017391348]]],
                [95.6556, [[-77.69529592048349, -0.08820344906493197], [-77.6952263458109, -0.08829343134169114], [-76.94806237315476, -0.08834039185278814], [-76.94714518629777, -0.0850169326428167], [-76.9379819033173, -0.043240493454831525], [-76.92882009133291, -0.0012849755611482538], [-76.92558665556774, 0.013725505428095046], [-76.92468659069267, 0.018075136762330808], [-76.92468661779039, 0.0204901306529611], [-76.92824644165607, 0.022327927812139183], [-77.12952340951448, 0.07820125789409109], [-77.15449004719322, 0.08489040459633665], [-77.38033383590094, 0.14381439744818947], [-77.47595946633038, 0.1687512916791654], [-77.56592296389147, 0.1920581575759378], [-77.57957075303634, 0.1954908623696467], [-77.58585638217157, 0.1969362236538184], [-77.69521106066287, 0.2215923020119243], [-77.69531276892863, 0.221530128922084], [-77.69529592048349, -0.08820344906493197]]],
                [73.4056, [[-76.91292552495472, 0.9044939372639249], [-76.91323894229865, 0.9041781146780646], [-76.91593399356786, 0.8930299376007675], [-76.93018564667909, 0.831444999093735], [-76.93341259779227, 0.8173375369507251], [-76.93637066699357, 0.8043153354300676], [-76.96380297728342, 0.6825069197311144], [-76.96756872539927, 0.6656872121392322], [-77.07064250553368, 0.19992404863179458], [-77.09972912630474, 0.06837086453799061], [-77.13179030311102, -0.077010348871433], [-77.13259904886937, -0.08080897699980412], [-77.1336787526792, -0.08660447351332465], [-77.13367884453199, -0.08823022088959027], [-77.13278563503376, -0.08833018733059879], [-76.7092955204504, -0.08835221354193382], [-76.70933659967426, 0.4081222882656975], [-76.70950519609256, 0.9045961484750892], [-76.91292552495472, 0.9044939372639249]]],
                [84.9953, [[-77.69553626275491, 0.9039937196118262], [-77.69562620837374, 0.9039240811997873], [-77.69546829926149, 0.6558771960244861], [-77.69536062727619, 0.4078504538252646], [-77.69530316945585, 0.1598235414110291], [-77.69529592048359, -0.08820344680000186], [-77.69522634581081, -0.08829343134170647], [-76.93979934619999, -0.0883408267423803], [-76.93888246781587, -0.08501848248638205], [-76.93169554356119, -0.055901348755377805], [-76.88266098359048, 0.15569034082130492], [-76.77498196469637, 0.6505299900285865], [-76.73839629081564, 0.8198308854824481], [-76.72262040398807, 0.9021401228390634], [-76.72262151550188, 0.9044999148156985], [-76.72269114841392, 0.9045898708548903], [-77.69553626275491, 0.9039937196118262]]],
                [98.5858, [[-76.90405084573509, 0.9044986358683255], [-76.9043476672649, 0.9039002828012251], [-76.90515792990409, 0.9014491405236813], [-76.907310284118, 0.8927635444336813], [-76.92118217949428, 0.8334893682249703], [-76.9255962663759, 0.8140860806980094], [-76.94092537887144, 0.7465343644027842], [-76.95544964660672, 0.6825102909228384], [-77.0240611143586, 0.37190162548809846], [-77.03778933018098, 0.30951169527922295], [-77.07135536476588, 0.1567876488405335], [-77.108079723939, -0.010830163476229532], [-77.12263022020419, -0.07755337643552428], [-77.1242478061862, -0.08515102515432546], [-77.12451865541084, -0.08705898541923272], [-77.12451872143215, -0.08823074835494107], [-77.12362550706682, -0.08833071511663264], [-76.7092955204504, -0.0883522135418709], [-76.70933659967426, 0.4081222882656975], [-76.70950519609256, 0.9045961484743594], [-76.90405084573509, 0.9044986358683255]]],
                [97.6748, [[-76.7134568639338, 0.8977936544744125], [-76.71273781418675, 0.9012397556536029], [-76.71273938454904, 0.9045946132570863], [-77.69562625266623, 0.9039936524116204], [-77.69546829926149, 0.6558771960244861], [-77.69536062727619, 0.4078504538252646], [-77.69530316945585, 0.1598235414110291], [-77.69529591785381, -0.08829342626985247], [-76.93063584792718, -0.0883413068636987], [-76.92882227570473, -0.0808571728489445], [-76.89469120921913, 0.07322345191993676], [-76.84980142510601, 0.27614056833141754], [-76.79739608072809, 0.5139751047541082], [-76.76994753743597, 0.6389565682200585], [-76.75416320465038, 0.7109446026993714], [-76.72923554549155, 0.8248978235985855], [-76.72009074612652, 0.8668623801079336], [-76.71686340040212, 0.8818757399016327], [-76.7134568639338, 0.8977936544744125]]],
                [100, [[-77.12263280716313, -0.08823487730746624], [-77.12110876344347, -0.08833085972805366], [-76.70929552045041, -0.08835221354185281], [-76.70933659967426, 0.4081222882656975], [-76.70950519609256, 0.9045961484742016], [-76.90236915516373, 0.9044995237954973], [-76.90300293507279, 0.9022621910079479], [-76.9051548829975, 0.8935782407317899], [-76.92101992933503, 0.8241251686413353], [-76.9255915499727, 0.8040492168895446], [-76.94011393171726, 0.7394817308018347], [-76.95840403730107, 0.658095736767001], [-76.96755016779159, 0.6171320722248012], [-76.99732882785855, 0.48351109417296756], [-77.02863508447518, 0.34233452025681593], [-77.06605897531381, 0.17144406308007437], [-77.09891956349922, 0.0214468872830362], [-77.12263274078461, -0.08705572904178603], [-77.12263280716313, -0.08823487730746624]]],
                [99.9972, [[-77.69529592048359, -0.08820344680000186], [-77.69522634581078, -0.08829343134171524], [-76.93386797835161, -0.08834113777583119], [-76.92882146058237, -0.06584642157922786], [-76.8855330358137, 0.1301908988083248], [-76.83562369011393, 0.35644146584498915], [-76.77497595582679, 0.632986518612055], [-76.75004481957271, 0.7469375628084057], [-76.72260879242708, 0.8726489095087308], [-76.72009868750234, 0.884406431158832], [-76.71597316960788, 0.9037701291704774], [-76.71597351382452, 0.9045030857626627], [-76.71604314657125, 0.9045930418899017], [-77.69562625266623, 0.9039936524113539], [-77.69546829926149, 0.6558771960244861], [-77.69536062727619, 0.4078504538252646], [-77.69530316945585, 0.1598235414110291], [-77.69529592048359, -0.08820344680000186]]],
                [90.7682, [[-77.69553626275489, 0.9039937196118262], [-77.69562620837374, 0.9039240811997908], [-77.69546829926149, 0.6558771960244861], [-77.69536062727619, 0.4078504538252646], [-77.69530316945585, 0.1598235414110291], [-77.69529592048359, -0.08820344680000186], [-77.69522634581081, -0.08829343134170475], [-76.94054894211757, -0.08834078736496358], [-76.93978619971062, -0.08757298517448567], [-76.90852236638199, 0.04283977487809186], [-76.88266100286717, 0.15569026213753814], [-76.84603635088864, 0.3206306305964098], [-76.77713189424787, 0.6331667694422443], [-76.74269725662799, 0.7937850362356265], [-76.72190204302501, 0.9028639643009213], [-76.72190281374253, 0.9045002582240204], [-76.72197244663667, 0.9045902142598782], [-77.69553626275489, 0.9039937196118262]]],
                [80.9924, [[-77.0614883149143, 0.24549388278360454], [-77.07522075246122, 0.18310648295316434], [-77.09892120304215, 0.07542296571501517], [-77.11346806137121, 0.009241238219441986], [-77.11804818674736, -0.011643769808324015], [-77.13179020286962, -0.07456936619321931], [-77.13421600210658, -0.08596314261364858], [-77.1345898767768, -0.08822072035660057], [-77.13350357504382, -0.08833014586853205], [-76.70929552045041, -0.08835221354193763], [-76.70933659967426, 0.4081222882656975], [-76.70950519609256, 0.904596148475135], [-76.91356478920552, 0.9044935979879601], [-76.91647276754323, 0.8927586146257381], [-76.93552871596057, 0.8102007790938041], [-76.9538524042983, 0.7294392037151117], [-76.96756998309591, 0.6689424693651476], [-77.0340298652017, 0.370000668369179], [-77.0614883149143, 0.24549388278360454]]],
                [97.3167, [[-77.69553626275528, 0.9039937196118255], [-77.69562620837374, 0.9039240811997875], [-77.69546829926149, 0.6558771960244861], [-77.69536062727619, 0.4078504538252646], [-77.69530316945585, 0.1598235414110291], [-77.69529592048359, -0.08820344680000186], [-77.69522634581088, -0.08829343134169824], [-76.94392744833618, -0.08834060970830793], [-76.9430131986138, -0.0842917617750267], [-76.93798248572962, -0.06150564009231992], [-76.84604335685886, 0.35779582251210995], [-76.75418935457996, 0.7771395886509708], [-76.7292650930025, 0.8910944762748687], [-76.72693294719767, 0.9028612315152357], [-76.72693372032036, 0.9044978514789531], [-76.72700335333958, 0.9045878074193467], [-77.69553626275528, 0.9039937196118255]]],
                [99.7132, [[-76.7093855208315, -0.08835220937365572], [-76.70929552620856, -0.08828262077779435], [-76.70933659967426, 0.4081222882656975], [-76.70950516552598, 0.9045061476782632], [-76.70957479805138, 0.9045961154523886], [-76.91592277927903, 0.9044923454730445], [-76.91889799493737, 0.8924859876799565], [-76.91970481390298, 0.8889582540056584], [-76.9226624564924, 0.8759358649076001], [-76.96757325198892, 0.6770801764173731], [-76.99581939878445, 0.5501218148215739], [-77.01034906010024, 0.48474538509826737], [-77.04318345752908, 0.33690661138848593], [-77.07602964196731, 0.18853128527143706], [-77.12262834582779, -0.022221605224723447], [-77.13178963763116, -0.06371978339076438], [-77.13637119622258, -0.08460660024813751], [-77.13664228996818, -0.08624356151853325], [-77.13664240176517, -0.08822571340388717], [-77.13602108805671, -0.08833000036848417], [-76.7093855208315, -0.08835220937365572]]],
                [97.123, [[-76.9472327420047, -0.08834043559642367], [-76.94718116260479, -0.08832621622127185], [-76.94643370741944, -0.08757380293026283], [-76.94552849993292, -0.08429374533055424], [-76.93546698955305, -0.03890049410671104], [-76.83689256671033, 0.40979275453826985], [-76.73841364970158, 0.8585341250733999], [-76.73679991563249, 0.865950441596826], [-76.72855123624178, 0.9044854481587462], [-76.72861415210076, 0.9045870353176948], [-77.69553626275543, 0.9039937196118257], [-77.69562620837374, 0.9039240811997916], [-77.69546829926149, 0.6558771960244861], [-77.69536062727619, 0.4078504538252646], [-77.69530316945585, 0.1598235414110291], [-77.69529592048359, -0.08820344680000186], [-77.6952263458109, -0.0882934313416937], [-76.9472327420047, -0.08834043559642367]]],
                [97.82, [[-77.69529592048359, -0.08820344680000186], [-77.6952263458109, -0.0882934313416937], [-76.94719529024391, -0.08834043757302783], [-76.94643370741944, -0.08757380293025877], [-76.94552847665719, -0.08429366098992996], [-76.9379820934177, -0.0499316833366323], [-76.84398190262971, 0.3794984950444183], [-76.75007034611643, 0.8089730519439515], [-76.7418223654792, 0.847500373975088], [-76.73841577889038, 0.8634177845944011], [-76.73106500412398, 0.8977854003047273], [-76.73016675078568, 0.9021358710764864], [-76.73016786746891, 0.9044963005653359], [-76.73023750056852, 0.9045862564614042], [-77.69562625266623, 0.9039936524101825], [-77.69546829926149, 0.6558771960244861], [-77.69536062727619, 0.4078504538252646], [-77.69530316945585, 0.1598235414110291], [-77.69529592048359, -0.08820344680000186]]],
                [1.5795, [[-77.13718122548573, -0.08814953489969979], [-77.13711910107409, -0.08823750595410658], [-77.13601735903853, -0.08833000058400757], [-76.7093855208315, -0.08835220937365572], [-76.70929552620856, -0.08828262077779435], [-76.70933659967426, 0.4081222882656975], [-76.70950516552598, 0.9045061476782632], [-76.70957479805142, 0.9045961154523985], [-76.91644715354983, 0.9044920667268851], [-76.91674551000085, 0.9038906143218364], [-76.9188993572063, 0.8951988292938979], [-76.92105065579338, 0.8859737615980167], [-76.96300184532883, 0.7001390159892109], [-76.97752670811407, 0.6347599233989215], [-77.00039402364557, 0.5316749972474112], [-77.06875942572694, 0.2218947982499988], [-77.13718120948221, -0.08786848799118493], [-77.13718122548573, -0.08814953489969979]]],
                [28.4887, [[-77.69529592048359, -0.08820344680000186], [-77.69522634581088, -0.08829343134169658], [-76.94555411209438, -0.08834052405948316], [-76.9446313376678, -0.08592551591686165], [-76.93133518458146, -0.02551814274623299], [-76.92217379736935, 0.016256672073071014], [-76.83608402238504, 0.4092504347810948], [-76.75006753367276, 0.802280998369578], [-76.73428842828574, 0.8744519419277273], [-76.7326747450198, 0.8818682530886716], [-76.72926828118634, 0.8977861596676957], [-76.72854925225745, 0.9012322352990229], [-76.7285507945881, 0.90449707635463], [-76.72862042764756, 0.9045870323026561], [-77.69562625266623, 0.9039936524103165], [-77.69546829926149, 0.6558771960244861], [-77.69536062727619, 0.4078504538252646], [-77.69530316945585, 0.1598235414110291], [-77.69529592048359, -0.08820344680000186]]],
                [82.7239, [[-76.70950516552598, 0.9045061476782632], [-76.70957479805129, 0.9045961154523751], [-76.91508139980658, 0.9044927925624271], [-76.91539481662271, 0.9041769701332226], [-76.91808988516172, 0.8930286929807053], [-76.9188966469746, 0.8895012081484851], [-76.9218542982019, 0.8764787769379859], [-76.96757173938522, 0.6732825001418486], [-76.97214444205824, 0.652664939779692], [-76.97833130774582, 0.6247230723955836], [-76.98667070674074, 0.5870154521225909], [-77.02407219663695, 0.4177427044830047], [-77.13259840056564, -0.07402677001211158], [-77.13502421525247, -0.08542063766636347], [-77.1352952647421, -0.08705732667961644], [-77.13529533115697, -0.08823012757139954], [-77.13440212251145, -0.08833009395650875], [-76.70929552045041, -0.088352213541944], [-76.70933659967426, 0.4081222882656975], [-76.70950516552598, 0.9045061476782632]]],
                [95.2882, [[-77.69553626275528, 0.9039937196118255], [-77.69562620837374, 0.9039240811997875], [-77.69546829926149, 0.6558771960244861], [-77.69536062727619, 0.4078504538252646], [-77.69530316945585, 0.1598235414110291], [-77.69529592048359, -0.08820344680000186], [-77.69522634581088, -0.08829343134169824], [-76.94393743368578, -0.08834060918219189], [-76.94301483838274, -0.0859260695177282], [-76.9404979682067, -0.07506913413814094], [-76.84523536867383, 0.3598758020486038], [-76.75006438683806, 0.794865744747739], [-76.74845048527968, 0.8022818567064568], [-76.72926507044248, 0.8910945901010066], [-76.72693294719767, 0.9028612315152357], [-76.72693372032036, 0.9044978514789531], [-76.72700335333958, 0.9045878074193467], [-77.69553626275528, 0.9039937196118255]]],
                [100, [[-77.13175778141115, -0.088189712911185], [-77.13172897139656, -0.08823837908734941], [-77.1302689064416, -0.08833033256501258], [-76.70938552083145, -0.08835220937365572], [-76.70929552620858, -0.08828262077779855], [-76.70933659967426, 0.4081222882656975], [-76.70950516552598, 0.9045061476782632], [-76.70957479805104, 0.9045961154523127], [-76.91181013038715, 0.9044945289903721], [-76.9118617075005, 0.9044802797791026], [-76.91214331159065, 0.9041965147587485], [-76.91216354856981, 0.904168764656538], [-76.91512483412554, 0.8914021937950689], [-76.91888917025516, 0.8748527385347367], [-76.92561125754573, 0.8450100712046275], [-76.9729459146172, 0.6347617510800962], [-77.03860309247726, 0.3369074499961241], [-77.12882650559274, -0.07321305076330548], [-77.13179285967092, -0.08678397685106964], [-77.13179293677277, -0.08814984598902166], [-77.13175778141115, -0.088189712911185]]],
                [51.4218, [[-76.72266229726938, 0.9045475125728192], [-76.72269114841392, 0.9045898708548891], [-77.69553626275491, 0.9039937196118262], [-77.69562620837374, 0.9039240811997873], [-77.69546829926149, 0.6558771960244861], [-77.69536062727619, 0.4078504538252646], [-77.69530316945585, 0.1598235414110291], [-77.69529592048359, -0.08820344680000186], [-77.69522634581081, -0.08829343134170475], [-76.94058639387832, -0.08834078539507699], [-76.94053481448103, -0.08832656601072926], [-76.93980398440303, -0.08759088784526131], [-76.93978485247635, -0.08756555256960817], [-76.93654656177219, -0.07543302189270495], [-76.89990112194705, 0.08190345620945513], [-76.81050407407537, 0.4899177174888732], [-76.72118064793669, 0.8979815918736385], [-76.72118317914035, 0.8980089065243361], [-76.72262364019315, 0.9045193104680777], [-76.72266229726938, 0.9045475125728192]]],
                [10.5197, [[-76.70938552083142, -0.08835220937365572], [-76.70929552620858, -0.0882826207777975], [-76.70933659967426, 0.4081222882656975], [-76.70950516552598, 0.9045061476782632], [-76.70957479805058, 0.9045961154522123], [-76.90645788404206, 0.9044973636437286], [-76.90676954146247, 0.904183315606973], [-76.90758319932596, 0.9014479740082353], [-76.90812201278094, 0.8995458858402554], [-76.96459796506086, 0.6485991824013114], [-76.99580589089709, 0.50780621301714], [-77.01491216794788, 0.42154261401803306], [-77.0286387576203, 0.3594231878656057], [-77.07521713004816, 0.1483877739491785], [-77.12721284518256, -0.08759785378845608], [-77.12721288114788, -0.08823339890620993], [-77.12595890864924, -0.0883305808867519], [-76.70938552083142, -0.08835220937365572]]],
                [98.5105, [[-77.69553626275444, 0.9039937196118265], [-77.69562620837374, 0.9039240811997906], [-77.69546829926149, 0.6558771960244861], [-77.69536062727619, 0.4078504538252646], [-77.69530316945585, 0.1598235414110291], [-77.69529592048359, -0.08820344680000186], [-77.6952263458108, -0.08829343134171257], [-76.93480644752724, -0.08834108862476645], [-76.93385898516796, -0.0875780923522526], [-76.92882139569758, -0.06494206927608907], [-76.84603487394021, 0.31249247515133577], [-76.76331819743896, 0.6899613546799955], [-76.74090025353311, 0.7923375713893431], [-76.73928631718758, 0.799753721096616], [-76.72010062432946, 0.8885662183289829], [-76.71848687731827, 0.8961641950784117], [-76.71687243595872, 0.9044911772360704], [-76.71693665126918, 0.9045926164138471], [-77.69553626275444, 0.9039937196118265]]],
                [70.8644, [[-76.70950516552598, 0.9045061476782632], [-76.7095747980505, 0.9045961154521982], [-76.90567697627752, 0.9044977765674632], [-76.90731308126121, 0.8995483592229059], [-76.90812069050804, 0.8960171615573606], [-76.96378956406986, 0.6485995900477004], [-76.96755561953064, 0.631779986861507], [-76.9721287854144, 0.6111625837682266], [-76.97831629600373, 0.5832208699672006], [-77.01948656600739, 0.39712895153700684], [-77.0431743784408, 0.28998103937943465], [-77.12343827583486, -0.07402722053062848], [-77.12586448107244, -0.08542293494523168], [-77.12613518219082, -0.08760214388112225], [-77.12613521774006, -0.08823065543570363], [-77.12524200421679, -0.08833062214268707], [-76.7092955204504, -0.08835221354188108], [-76.70933659967426, 0.4081222882656975], [-76.70950516552598, 0.9045061476782632]]],
                [44.4346, [[-76.93477429601612, -0.08759114949521245], [-76.9347538833062, -0.08756304612350371], [-76.93133659831854, -0.07253756954131749], [-76.83149723371427, 0.382846920774828], [-76.73175673836766, 0.8382807168886236], [-76.72099898959226, 0.8885658391400227], [-76.7184886336964, 0.900324937859903], [-76.71777089761636, 0.9044908697912823], [-76.71783654817195, 0.9045921876643352], [-77.69553626275453, 0.9039937196118264], [-77.69562620837374, 0.9039240811997888], [-77.69546829926149, 0.6558771960244861], [-77.69536062727619, 0.4078504538252646], [-77.69530316945585, 0.1598235414110291], [-77.69529592048359, -0.08820344680000186], [-77.6952263458108, -0.08829343134171255], [-76.9355567075395, -0.08834104931379257], [-76.93550512814424, -0.08832682992250927], [-76.93477429601612, -0.08759114949521245]]],
                [99.0181, [[-76.90434766727434, 0.9039002827822135], [-76.9046193372071, 0.9030784475407136], [-76.9051584262801, 0.9011753863143351], [-76.90731009244037, 0.891948768458567], [-76.95006833137148, 0.7020433590221336], [-76.95464091935837, 0.6816968780066104], [-76.95840670900914, 0.6648771676386974], [-76.97212591605408, 0.6032962030703629], [-76.98208018594673, 0.5585353328658198], [-76.98665409150384, 0.5379183488286784], [-77.0149092860008, 0.41015006596738635], [-77.03321237831868, 0.3271436993189292], [-77.12263025422448, -0.07863820816731397], [-77.12424764932503, -0.08623493409846182], [-77.1245770916197, -0.0882242156797642], [-77.12362550706682, -0.08833071511663249], [-76.7092955204504, -0.0883522135418709], [-76.70933659967426, 0.4081222882656975], [-76.70950519609256, 0.9045961484743594], [-76.90405084573507, 0.9044986358683249], [-76.90434766727434, 0.9039002827822135]]],
                [96.2216, [[-77.69529592048359, -0.08820344680000186], [-77.69522634581078, -0.08829343134171524], [-76.93390256769207, -0.08834113596274056], [-76.93314097945361, -0.0875744953243971], [-76.93223580103987, -0.08429453864782513], [-76.92882158128013, -0.06910156335773318], [-76.91301241437873, 0.0028742232678376227], [-76.81983018903072, 0.427701280833199], [-76.73426340981457, 0.8182038537004831], [-76.72601536981604, 0.8567315251377629], [-76.72260875441899, 0.8726490875420819], [-76.72009868750234, 0.884406431158832], [-76.71597316960788, 0.9037701291704774], [-76.71597351382452, 0.9045030857626627], [-76.71604314657125, 0.9045930418899017], [-77.69562625266623, 0.9039936524113539], [-77.69546829926149, 0.6558771960244861], [-77.69536062727619, 0.4078504538252646], [-77.69530316945585, 0.1598235414110291], [-77.69529592048359, -0.08820344680000186]]],
                [10.9262, [[-77.12125120491305, -0.08818959021083231], [-77.12122425973021, -0.08823820788436805], [-77.1202119883387, -0.0883309112151593], [-76.70938552083136, -0.08835220937365572], [-76.70929552620858, -0.08828262077779975], [-76.70933659967426, 0.4081222882656975], [-76.70950516552598, 0.9045061476782632], [-76.7095747980501, 0.9045961154521065], [-76.90076122204768, 0.9045003719650432], [-76.90079594203598, 0.9044697230772554], [-76.90084286844365, 0.9044533042247426], [-76.90273134233027, 0.8973778716482943], [-76.95382767407396, 0.6694903987531045], [-76.98664890120725, 0.5216430751113085], [-77.01032991873424, 0.4147625532537065], [-77.03778584383525, 0.29079577994088285], [-77.10349954387412, -0.007032751854906017], [-77.11346890219485, -0.05232873827161882], [-77.12128570332594, -0.08786944151631197], [-77.1212857192083, -0.08815045026588542], [-77.12125120491305, -0.08818959021083231]]],
                [17.4697, [[-77.1280211233722, -0.08815006325522334], [-77.12795899893877, -0.08823803427099483], [-77.12685725042353, -0.08833052917001974], [-76.70938552083142, -0.08835220937365572], [-76.70929552620858, -0.0882826207777926], [-76.70933659967426, 0.4081222882656975], [-76.70950516552598, 0.9045061476782632], [-76.70957479805064, 0.9045961154522324], [-76.90756193690659, 0.9044967795724381], [-76.90893036511504, 0.9006334428188517], [-76.91188914499953, 0.8876058544744576], [-76.96459983353213, 0.6534819321329091], [-76.96836584719715, 0.6366622900957046], [-76.9866593541635, 0.5539223511525113], [-77.02406406391822, 0.384650343132189], [-77.0332156784299, 0.3431472939314075], [-77.12721056681309, -0.0832488988649107], [-77.12802106160846, -0.08705566841224073], [-77.1280211233722, -0.08815006325522334]]],
                [77.1013, [[-77.69529592048359, -0.08820344680000186], [-77.69522634581081, -0.08829343134170647], [-76.93983613601439, -0.08834082480805566], [-76.93889011291012, -0.08757898778524974], [-76.937983824352, -0.08411259901368054], [-76.83939793977541, 0.3649408116088504], [-76.74090944548867, 0.8140409639657732], [-76.73176461003246, 0.8560052563483513], [-76.72764078276005, 0.875178802520011], [-76.7226204043747, 0.8986952027488638], [-76.72190204340478, 0.9028647705695487], [-76.72190281374253, 0.9045002582240204], [-76.72197244663667, 0.9045902142598782], [-77.69562625266623, 0.9039936524108649], [-77.69546829926149, 0.6558771960244861], [-77.69536062727619, 0.4078504538252646], [-77.69530316945585, 0.1598235414110291], [-77.69529592048359, -0.08820344680000186]]],
                [47.0153, [[-76.72858738788553, 0.9045385246037042], [-76.72862042764756, 0.9045870323026549], [-77.69553626275543, 0.9039937196118257], [-77.69557770309818, 0.9039571221629764], [-77.69562620837374, 0.9039240811997916], [-77.69546829926149, 0.6558771960244861], [-77.69536062727619, 0.4078504538252646], [-77.69530316945585, 0.1598235414110291], [-77.69529592048359, -0.08820344680000186], [-77.69525935255231, -0.0882449084449208], [-77.69522634581088, -0.08829343134169565], [-76.94651421915353, -0.08834047347006442], [-76.94648605864057, -0.0883156409031728], [-76.94644867564432, -0.08831215035938032], [-76.94643542823998, -0.08829396714947213], [-76.94553588079718, -0.0866640702618068], [-76.94552815661059, -0.08664259823553026], [-76.8796125455116, 0.20813669791655456], [-76.81374132531195, 0.5029384516442641], [-76.7285500204363, 0.902859810504602], [-76.72855079458813, 0.9044970763929453], [-76.72858738788553, 0.9045385246037042]]],
                [7.4474, [[-76.70938552083152, -0.08835220937365576], [-76.70929552620858, -0.0882826207777927], [-76.70933659967426, 0.4081222882656975], [-76.70950516552598, 0.9045061476782632], [-76.70957479805156, 0.9045961154524337], [-76.91834275611289, 0.9044910584407413], [-76.91863305585117, 0.9036128536372681], [-76.92266849863526, 0.8884156631494716], [-76.96381292676486, 0.7066490126090681], [-76.9683853783712, 0.6863026235011105], [-76.97215104858529, 0.6694830246033254], [-76.99582377613741, 0.5631419833795943], [-77.01035295423476, 0.49776542682154856], [-77.0332273630896, 0.39468435326183915], [-77.07522335313173, 0.20453449422400027], [-77.1317892105175, -0.052328108586634385], [-77.13960593317927, -0.08786838917067263], [-77.1396059538805, -0.08823152343017376], [-77.13853223024407, -0.08832985506557046], [-76.70938552083152, -0.08835220937365576]]],
                [92.7665, [[-77.69529592048359, -0.08820344680000186], [-77.69522634581091, -0.08829343134168817], [-76.95061398916845, -0.08834025718370425], [-76.94966653494627, -0.08757726812597932], [-76.9446289916766, -0.06494149159372357], [-76.93798172598159, -0.034740993650456096], [-76.84272869779555, 0.3993020094279358], [-76.7475656315948, 0.8333902295333502], [-76.74595183594663, 0.840806488520968], [-76.7351944275331, 0.8910912262028371], [-76.73268253540299, 0.9028578109477362], [-76.73268331141244, 0.9044950923257865], [-76.73275294457461, 0.9045850481570776], [-77.69562625266623, 0.9039936524099755], [-77.69546829926149, 0.6558771960244861], [-77.69536062727619, 0.4078504538252646], [-77.69530316945585, 0.1598235414110291], [-77.69529592048359, -0.08820344680000186]]],
                [100, [[-76.70938552083153, -0.08835220937365573], [-76.70929552620858, -0.08828262077779511], [-76.70933659967426, 0.4081222882656975], [-76.70950516552598, 0.9045061476782632], [-76.70957479805175, 0.9045961154524782], [-76.92074055828985, 0.9044897815956506], [-76.92105239344974, 0.9041755519829237], [-76.92240395543986, 0.899540811562675], [-76.92428728439711, 0.8927564236399174], [-76.92563241057509, 0.8873282770303108], [-76.98210814205973, 0.6366572001010223], [-76.98668127091972, 0.616311140338789], [-77.04776453168992, 0.34016053104108995], [-77.14095059793047, -0.08134952234694504], [-77.1417597600456, -0.0851500490557395], [-77.14203060705957, -0.08705798748976067], [-77.14203067367528, -0.0882306382320745], [-77.14104716506978, -0.08832970937229832], [-76.70938552083153, -0.08835220937365573]]],
                [77.5342, [[-77.6955362627559, 0.9039937196118254], [-77.69562620837374, 0.9039240811997885], [-77.69546829926149, 0.6558771960244861], [-77.69536062727619, 0.4078504538252646], [-77.69530316945585, 0.1598235414110291], [-77.69529592048359, -0.08820344680000186], [-77.69522634581092, -0.08829343134168605], [-76.95129764787522, -0.08834022107423278], [-76.95055854294463, -0.08592238930773806], [-76.94714408866002, -0.0707284694455768], [-76.91714522443421, 0.06454201234005635], [-76.84093494267263, 0.4112386243917183], [-76.7647817411616, 0.7579642568112274], [-76.73429883320287, 0.9012293036285474], [-76.73430038074275, 0.9044943146251451], [-76.73437001394512, 0.9045842704641948], [-77.6955362627559, 0.9039937196118254]]],
                [50.9507, [[-76.70938552083153, -0.08835220937365573], [-76.70929552620858, -0.08828262077779511], [-76.70933659967426, 0.4081222882656975], [-76.70950516552598, 0.9045061476782632], [-76.70957479805179, 0.9045961154524846], [-76.92103888425343, 0.9044896226298739], [-76.92240417067701, 0.9000836392636521], [-76.92428753325636, 0.8930272534115717], [-76.92563254035541, 0.8875995840611416], [-76.97376995160872, 0.6749076630166173], [-76.97753571720648, 0.6580880489691014], [-77.00578271745705, 0.5308595080765469], [-77.03403774857539, 0.4030927841640452], [-77.14175985144848, -0.0846080197218744], [-77.14203059181615, -0.08678754665744144], [-77.14203067366813, -0.08823063823279585], [-77.14104716506978, -0.08832970937229837], [-76.70938552083153, -0.08835220937365573]]],
                [91.3793, [[-77.69553626275587, 0.9039937196118254], [-77.69562620837374, 0.9039240811997898], [-77.69546829926149, 0.6558771960244861], [-77.69536062727619, 0.4078504538252646], [-77.69530316945585, 0.1598235414110291], [-77.69529592048359, -0.08820344680000186], [-77.69522634581092, -0.08829343134168605], [-76.9513267906491, -0.0883402195329316], [-76.95056520951533, -0.08757358676158807], [-76.94966049057567, -0.08429530080627576], [-76.93438931968313, -0.026604883407307114], [-76.83680603859052, 0.42426125415192323], [-76.73931953494291, 0.8751733199439379], [-76.73429925113706, 0.8986896384125356], [-76.73358090787806, 0.9028591828019841], [-76.73358168343434, 0.9044946603806804], [-76.73365131661883, 0.9045846161949267], [-77.69553626275587, 0.9039937196118254]]],
                [66.9258, [[-76.7093855208315, -0.08835220937365572], [-76.70929552620858, -0.08828262077779567], [-76.70933659967426, 0.4081222882656975], [-76.70950516552598, 0.9045061476782632], [-76.7095747980516, 0.904596115452445], [-76.91888629932299, 0.9044907691423157], [-76.92186226814648, 0.8930282337628799], [-76.92266935804332, 0.8897712888594349], [-76.92562716017518, 0.8767481238223246], [-76.98210437477731, 0.6266205819973454], [-77.03322738395997, 0.39468425870131496], [-77.13178924491936, -0.05314182996676376], [-77.13637021331478, -0.0740266432597418], [-77.13879601108978, -0.08542042638643366], [-77.13906706007403, -0.08705711134802673], [-77.13906712681406, -0.08823357720630523], [-77.13763309135801, -0.08832990711222745], [-76.7093855208315, -0.08835220937365572]]],
                [60.0523, [[-77.69553626275555, 0.9039937196118255], [-77.69562620837374, 0.9039240811997865], [-77.69546829926149, 0.6558771960244861], [-77.69536062727619, 0.4078504538252646], [-77.69530316945585, 0.1598235414110291], [-77.69529592048359, -0.08820344680000186], [-77.6952263458109, -0.0882934313416926], [-76.94806237315476, -0.08834039185278751], [-76.94714540914993, -0.08501774015553437], [-76.93007779542619, -0.013583316549874805], [-76.85950734101912, 0.30814967326414144], [-76.78898823836886, 0.6299071668870354], [-76.74702200950493, 0.8230818308501141], [-76.73016752049382, 0.9037635299560765], [-76.73016786746892, 0.9044963006036872], [-76.73023750056852, 0.9045862564614063], [-77.69553626275555, 0.9039937196118255]]],
                [0.2635, [[-76.70938552083146, -0.08835220937365572], [-76.70929552620858, -0.08828262077779424], [-76.70933659967426, 0.4081222882656975], [-76.70950516552598, 0.9045061476782632], [-76.70957479805122, 0.904596115452359], [-76.91430587436975, 0.9044932044965621], [-76.91486069547928, 0.9022542304663973], [-76.91754988024402, 0.8911303467304655], [-76.92104564853925, 0.8762082312762813], [-76.97295004137574, 0.6456121312934061], [-76.98666964292684, 0.5840317079238799], [-77.02864672917059, 0.39387167159750075], [-77.03779807606742, 0.3523686589349663], [-77.12720926479217, -0.05476946790218857], [-77.13340714010313, -0.08324867964462648], [-77.13421760710311, -0.08705531565490769], [-77.1342176738094, -0.08823385744066746], [-77.13278363405978, -0.08833018744607313], [-76.70938552083146, -0.08835220937365572]]],
                [57.6908, [[-77.69553626275508, 0.9039937196118257], [-77.69562620837374, 0.9039240811997881], [-77.69546829926149, 0.6558771960244861], [-77.69536062727619, 0.4078504538252646], [-77.69530316945585, 0.1598235414110291], [-77.69529592048359, -0.08820344680000186], [-77.69522634581085, -0.08829343134170008], [-76.94232958446264, -0.08834069376934821], [-76.94140054246166, -0.08665735503207488], [-76.94049936620584, -0.08339189625106998], [-76.9365466398504, -0.0689240336003244], [-76.93007879974333, -0.04396696108435608], [-76.9106777561748, 0.03415925831377452], [-76.83203865059288, 0.39442147916343406], [-76.7534614320857, 0.7547138063533516], [-76.72549112107116, 0.8914627940331489], [-76.72441715793533, 0.9021432989179187], [-76.72441826870552, 0.904499055711133], [-76.7244879016622, 0.9045890117162474], [-77.69553626275508, 0.9039937196118257]]],
                [27.2538, [[-76.70950516552598, 0.9045061476782632], [-76.7095747980507, 0.904596115452239], [-76.90782364460134, 0.9044966410705018], [-76.90812107103818, 0.9038970670312493], [-76.90893119263788, 0.9011736112578599], [-76.9592199529607, 0.6770835098414788], [-76.97374571377925, 0.6117045467819541], [-76.99580730334306, 0.5124175606380189], [-77.00038166004637, 0.49180088789612336], [-77.01948862512245, 0.40553770566608893], [-77.0477525867242, 0.2777742039600364], [-77.12721050621107, -0.08216396120493634], [-77.12801945677083, -0.08596349086614684], [-77.12829050779116, -0.08760018740564678], [-77.12829054368784, -0.08823419908618627], [-77.12685649868898, -0.08833052921328145], [-76.7092955204504, -0.08835221354189125], [-76.70933659967426, 0.4081222882656975], [-76.70950516552598, 0.9045061476782632]]],
                [98.5926, [[-76.93440458004544, -0.08794231308548493], [-76.93439259403273, -0.08791493885508841], [-76.9149892017724, -0.02226625171030756], [-76.82880039761866, 0.3727197950812154], [-76.74268650139545, 0.7677410677172196], [-76.71776950459186, 0.9028662062186559], [-76.71777027333326, 0.904502229946763], [-76.71783990612464, 0.9045921860610382], [-77.69553626275453, 0.9039937196118264], [-77.69562620837374, 0.9039240811997888], [-77.69546829926149, 0.6558771960244861], [-77.69536062727619, 0.4078504538252646], [-77.69530316945585, 0.1598235414110291], [-77.69529592048359, -0.08820344680000186], [-77.6952263458108, -0.08829343134171257], [-76.93483817969248, -0.08834108696063936], [-76.93478660030513, -0.08832686757342184], [-76.93440458004544, -0.08794231308548493]]],
                [100, [[-77.69553626275405, 0.9039937196118267], [-77.69562620837374, 0.9039240811997875], [-77.69546829926149, 0.6558771960244861], [-77.69536062727619, 0.4078504538252646], [-77.69530316945585, 0.1598235414110291], [-77.69529592048359, -0.08820344680000186], [-77.69522634581075, -0.08829343134172085], [-76.92973995420954, -0.08834135368193138], [-76.92882290138749, -0.08501837392357742], [-76.92630700380771, -0.07416559065277707], [-76.8256588231866, 0.3833002444452021], [-76.72511002960078, 0.8408155992521552], [-76.71345524108501, 0.8945385964463294], [-76.71184019422074, 0.9028686066594451], [-76.71184096050621, 0.9045050506746951], [-76.7119105931502, 0.904595006901482], [-77.69553626275405, 0.9039937196118267]]],
                [80.2691, [[-76.70938552083138, -0.08835220937365576], [-76.70929552620858, -0.08828262077779822], [-76.70933659967426, 0.4081222882656975], [-76.70950516552598, 0.9045061476782632], [-76.7095747980502, 0.9045961154521294], [-76.9019041727376, 0.9044997691217741], [-76.90219434932084, 0.9036219501488674], [-76.90354042325299, 0.8987341343647671], [-76.95840245690823, 0.6540268353901331], [-76.96458954164302, 0.6263559469098623], [-76.97212206040878, 0.5924458357577476], [-77.03321022151644, 0.31629384563877944], [-77.11804964412593, -0.06833142699430475], [-77.12128344312109, -0.08324937450222107], [-77.12209390767667, -0.08705600487434045], [-77.12209397384896, -0.0882317878416264], [-77.12111045348092, -0.08833085963105544], [-76.70938552083138, -0.08835220937365576]]],
                [90.1987, [[-76.9323233298152, -0.088341218614693], [-76.93225439979226, -0.08831257926973288], [-76.93134024398641, -0.08665621190330132], [-76.92882202518653, -0.07579346604325704], [-76.88265854822886, 0.12530790545011491], [-76.81480164935478, 0.4345749537434955], [-76.7469891945096, 0.7438645712055268], [-76.71363819998535, 0.9044926191499002], [-76.71370152508186, 0.9045941559077523], [-77.69553626275417, 0.9039937196118267], [-77.69562620837374, 0.9039240811997906], [-77.69546829926149, 0.6558771960244861], [-77.69536062727619, 0.4078504538252646], [-77.69530316945585, 0.1598235414110291], [-77.69529592048359, -0.08820344680000186], [-77.69522634581077, -0.08829343134171627], [-76.9323233298152, -0.088341218614693]]]
        ]

        def scenes = []
        sceneData.eachWithIndex { scene, index ->
            def footprint = scene[1].collect {
                [it[0] as double, it[1] as double]
            }
            scenes << new Scene(index as String, new Date(), scene[0] / 100d, footprint)
        }
        def start = System.currentTimeMillis()
        def selectedScenes = tile.selectScenes(scenes, 0.9997, 1, Integer.MAX_VALUE, new Scenes.ScoringAlgorithm() {
            double score(Scene scene, double improvement) {
                improvement
            }
        })
        println(System.currentTimeMillis() - start)
//
//
        println(selectedScenes)
        println(selectedScenes.size())
        when:
        true

        then:
        true
    }


    void inRange(value, min, max) {
        assert value >= min
        assert value <= max
    }

    void containsSame(collection1, collection2) {
        assert collection1 as Set == collection2 as Set
    }

    double firstImprovement() {
        improvement(0)
    }

    List<Double> improvements() {
        scoreInvocations.collect { it.improvement } as List<Double>
    }

    double improvement(int i) {
        scoreInvocations.get(i).improvement as double
    }


    List<Scene> selectScenes(Map args = [:], List<Scene> scenes) {
        new Scenes(scenes).selectScenes(
                args.minCoverage ?: 1d as double,
                args.minScenes ?: 1 as int,
                args.maxScenes ?: Integer.MAX_VALUE as int,
                args.score ?: spyingScore as Scenes.ScoringAlgorithm
        )
    }

    Scene scene(Map args = [:]) {
        new Scene(
                args.id ?: "scene-${++sceneIndex}",
                args.date ?: new Date(),
                args.cloudCover ?: 0d,
                args.footprint ?: SQUARE
        )
    }
}
