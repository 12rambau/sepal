def mainClassName = 'org.openforis.sepal.component.user.Main'
description = ''

apply plugin: 'java'

dependencies {
    compile project(':sepal-common')
    compile group: 'org.openforis.rmb', name: 'repository-message-broker-xstream', version: '0.1.3'
    compile group: 'org.openforis.rmb', name: 'repository-message-broker-slf4j', version: '0.1.3'
    testCompile project(':sepal-common-test')
}

jar {
    manifest {
        attributes 'Main-Class': mainClassName
    }
    from {
        configurations.compile.collect { it.isDirectory() ? it : zipTree(it) }
    }
}

task copyJar(type: Copy) {
    println "${libsDir}/${project.name}-${version}.jar"
    from file("${libsDir}/${project.name}-${version}.jar")
    into file("${projectDir}/docker/binary")
    rename "${project.name}-${version}.jar", "${project.name}.jar"
}

build.dependsOn(copyJar)

task runDev(type: JavaExec) {
    classpath = sourceSets.main.runtimeClasspath + sourceSets.test.runtimeClasspath
    main = 'manual.UserTestMain'
    systemProperties(System.getProperties())
}
//  ./gradlew :sepal-server:runDev -DconfigDir=/path/to/sepal-config/user

