<html>
    <head>

    </head>
    <body>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.17.11/lodash.min.js"></script>
        <script>
const number = ({value = 0, scale = '', precisionDigits = 3, prefix = '', unit = ''}) => {
    if (precisionDigits < 3) {
        throw new Error('Unsupported number of precision digits (less than 3).')
    }
    const join = (...items) => _.compact(items).join(' ')
    // safe from pico to yotta
    const magnitudes = ['p', 'n', 'µ', 'm', '', 'k', 'M', 'G', 'T', 'P', 'E', 'Z', 'Y']
    const scaleMagnitude = magnitudes.indexOf(scale)
    if (scaleMagnitude === -1) {
        throw new Error('Unsupported scale.')
    }
    const digits = Math.max(Math.trunc(Math.log10(value)), 0)
    const valueMagnitude = Math.trunc(digits / 3)
    const magnitude = valueMagnitude + scaleMagnitude
    if (magnitude < 0 || magnitude > magnitudes.length - 1) {
        throw new Error('Out of range.')
    }
    const multiplier = Math.pow(10, 3 * valueMagnitude)
    const decimals = multiplier > 1 ? precisionDigits - digits % 3 - 1 : 0
    console.log({value, multiplier, digits, decimals, final: (value / multiplier).toFixed(decimals)})
    return join(prefix, (value / multiplier).toFixed(decimals), magnitudes[magnitude] + unit)
}
            const expect = (params, expected) => {
                const calculated = number(params)
                console.log(calculated === expected ? `Ok, got ${expected}.`: `Expected ${expected}, got ${calculated}.`)
            }

            expect({value: 18245.23, scale: 'k'}, '18.2 M')
            expect({value: 1000, scale: 'k'}, '1.00 M')
            expect({value: 18245.23, scale: 'µ'}, '18.2 m')
            expect({value: 4700.9938, scale: 'p'}, '4.70 n')
            expect({value: 46920395.334, scale: 'm'}, '46.9 k')
            expect({value: 1000, scale: 'Z'}, '1.00 Y')
            expect({value: 999999, scale: 'Z'}, '1000 Y')
        </script>
    </body>
</html>