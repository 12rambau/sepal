---
- name: "user-storage | Start container"
  docker_container:
    api_version: "{{ api_version }}"
    name: "{{ name }}"
    pull: "{{ pull }}"
    image: "{{ image }}"
    state: "{{ state }}"
    restart_policy: "{{ restart_policy }}"
    network_mode: "{{ network_mode }}"
    log_driver: syslog
    log_opt:
      syslog-address: "{{ syslog_address }}"
      tag: "user-storage"
    networks:
      - name: 'sepal'
    volumes:
      - "/data/sepal/home:/sepalUsers"
    env:
      - RABBITMQ_HOST: {{ rabbitmq_host }}
      - RABBITMQ_PORT: {{ rabbitmq_port }}
      - MIN_DELAY_SECONDS: 60
      - MAX_DELAY_SECONDS: 86400
      - DELAY_INCREASE_FACTOR: 2
      - CONCURRENCY: 5
      - MAX_RETRIES: 10
      - INITIAL_RETRY_DELAY_SECONDS: 30
  